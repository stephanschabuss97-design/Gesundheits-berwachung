<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="index_files/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Schabuss, Stephan</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Schabuss, Stephan</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:Created>2025-08-20T05:52:00Z</o:Created>
  <o:LastSaved>2025-08-20T05:54:00Z</o:LastSaved>
  <o:Pages>76</o:Pages>
  <o:Words>11841</o:Words>
  <o:Characters>74605</o:Characters>
  <o:Company>Novartis Pharma AG</o:Company>
  <o:Lines>621</o:Lines>
  <o:Paragraphs>172</o:Paragraphs>
  <o:CharactersWithSpaces>86274</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="index_files/themedata.thmx">
<link rel=colorSchemeMapping href="index_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>DE-AT</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="376">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Link"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536869121 1107305727 33554432 0 415 0;}
@font-face
	{font-family:Aptos;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 3 0 0 415 0;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:3 33554432 0 0 1 0;}
@font-face
	{font-family:"Segoe UI Symbol";
	panose-1:2 11 5 2 4 2 4 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-2147483165 302055407 262144 0 1 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h2
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h4
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 4 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-weight:normal;
	font-style:italic;}
h5
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 5 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h6
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 6 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 7 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 8 Char";
	mso-style-next:Normal;
	margin:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 9 Char";
	mso-style-next:Normal;
	margin:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:9;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Subtitle Char";
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Quote Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Intense Quote Char";
	mso-style-next:Normal;
	margin-top:18.0pt;
	margin-right:43.2pt;
	margin-bottom:18.0pt;
	margin-left:43.2pt;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-top-alt:solid #0F4761 .5pt;
	mso-border-top-themecolor:accent1;
	mso-border-top-themeshade:191;
	mso-border-bottom-alt:solid #0F4761 .5pt;
	mso-border-bottom-themecolor:accent1;
	mso-border-bottom-themeshade:191;
	padding:0cm;
	mso-padding-alt:10.0pt 0cm 10.0pt 0cm;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-style:italic;}
span.MsoIntenseEmphasis
	{mso-style-priority:21;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.MsoIntenseReference
	{mso-style-priority:32;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	font-variant:small-caps;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	letter-spacing:.25pt;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:20.0pt;
	mso-bidi-font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 4";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 5";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 6";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	font-style:italic;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 7";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 8";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	font-style:italic;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 9";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Title;
	mso-ansi-font-size:28.0pt;
	mso-bidi-font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Subtitle;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Quote;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Intense Quote";
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
.MsoPapDefault
	{mso-style-type:export-only;
	margin-bottom:8.0pt;
	line-height:115%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin-top:0cm;
	mso-para-margin-right:0cm;
	mso-para-margin-bottom:8.0pt;
	mso-para-margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=DE-AT style='tab-interval:35.4pt;word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal>&lt;!DOCTYPE html&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;html lang=&quot;de&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;head&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;meta charset=&quot;utf-8&quot; /&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;meta name=&quot;viewport&quot;
content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot;
/&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;title&gt;Gesundheits-Logger (V1.0  Realtime &amp;
Auto-Sync)&lt;/title&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;style&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>body.auth-locked
main{ opacity: .6; pointer-events: auto; } /* ist sowieso disabled, nur Visual
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>:root {
--bg:#0b0c10; --card:#15171c; --fg:#e8e8e8; --muted:#9aa3af; --accent:#4f46e5;
--warn:#f59e0b; --ok:#10b981; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>*{box-sizing:border-box}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>html,body{height:100%}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>body{margin:0;font-family:system-ui,-apple-system,Segoe
UI,Roboto,Inter,Helvetica,Arial;background:var(--bg);color:var(--fg);-webkit-tap-highlight-color:transparent;touch-action:manipulation;overscroll-behavior-y:none}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>header{position:sticky;top:0;background:linear-gradient(180deg,rgba(11,12,16,.95),rgba(11,12,16,.7));backdrop-filter:blur(6px);z-index:10;padding:10px
12px;border-bottom:1px solid #1f232b}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>h1{margin:0;font-size:20px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>nav.tabs{display:flex;gap:8px;padding:8px
12px;position:sticky;top:54px;background:rgba(11,12,16,.9);backdrop-filter:blur(6px);z-index:11}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>nav.tabs
button{flex:1;min-width:100px;touch-action:manipulation}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>main{padding:12px;position:relative;z-index:1}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.card{background:var(--card);border:1px solid
#242833;border-radius:16px;padding:14px;margin-bottom:12px;box-shadow:0 6px
18px rgba(0,0,0,.25)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.row{display:flex;gap:8px;flex-wrap:wrap}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>@media
(max-width:640px){ .grid{grid-template-columns:1fr} }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>input, select,
textarea {width:100%;padding:12px;border-radius:12px;border:1px solid
#2b2f3a;background:#0f1116;color:var(--fg);font-size:16px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>textarea{min-height:64px;resize:vertical}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.small{font-size:12px;color:var(--muted)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.btn{appearance:none;border:none;border-radius:12px;padding:12px
14px;font-weight:600;color:white;background:#2b2f3a;cursor:pointer;touch-action:manipulation;transition:
background .25s ease, color .25s ease, transform .06s ease, box-shadow .25s
ease}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.btn:disabled{opacity:.6;cursor:not-allowed}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.btn:active{
transform: scale(0.98) }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.btn.primary{background:var(--accent)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.btn.ghost{background:#0f1116;border:1px solid #2b2f3a;color:var(--fg)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.btn.warn{background:var(--warn);color:#1a1200}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.btn.toggle.active{
background: var(--ok); color:#06110b; border-color: transparent; }<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.btn.flash{background:linear-gradient(90deg,var(--accent) 0%,#7c3aed
50%,var(--accent) 100%)!important;background-size:200%
100%;color:#fff!important;animation:flashGradient 1.2s ease forwards,flashPop
.2s ease;box-shadow:0 6px 24px rgba(79,70,229,.35)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>@keyframes
flashGradient{0%{background-position:0% 50%}100%{background-position:100% 50%}}<o:p></o:p></p>

<p class=MsoNormal>@keyframes flashPop {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>0%<span
style='mso-spacerun:yes'> </span>{ transform: scale(1) }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>50%<span
style='mso-spacerun:yes'> </span>{ transform: scale(1.03) }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>100% { transform:
scale(1) }<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.spacer{flex:1}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>section.view{display:none}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>section.view.active{display:block}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#doctorTable
thead{position:sticky;top:0;background:#0f1116}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#doctorCard
.toolbar{border-bottom:1px solid #242833;padding-bottom:8px;margin-bottom:8px}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>@media print{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>body{background:white;color:black}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>header, nav.tabs,
.toolbar, .card:not(#doctorCard), .fab-wrap, #chart, #chartReports
{display:none !important}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>#doctorCard{border:none;box-shadow:none}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>#doctorTitle{font-size:18px;margin-bottom:10px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#doctorTable th,
#doctorTable td{border:1px solid #999;padding:6px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>#doctorTable{border:1px solid #999}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>#err{position:fixed;left:8px;right:8px;bottom:8px;background:#3d0d0d;color:#fecaca;padding:8px
10px;border-radius:10px;display:none;z-index:9999}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/* Panels */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.panel{position:fixed;right:8px;bottom:8px;width:340px;max-height:70vh;overflow:auto;background:#0f1116;border:1px
solid #2b2f3a;border-radius:12px;box-shadow:0 6px 18px
rgba(0,0,0,.35);display:none;z-index:9998}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.panel
header{display:flex;gap:6px;align-items:center;justify-content:space-between;padding:8px;border-bottom:1px
solid #2b2f3a}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.panel
h4{margin:0;font-size:14px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.panel
.content{padding:10px;font-size:13px;line-height:1.45}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#diag
pre{margin:0;padding:8px;font-size:12px;white-space:pre-wrap}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/* FABs */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.fab-wrap{position:fixed;right:8px;bottom:8px;display:flex;flex-direction:column;gap:8px;z-index:9999}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.fab{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:1px
solid #2b2f3a;background:#0f1116;cursor:pointer}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.fab:hover{box-shadow:0 8px 24px rgba(0,0,0,.35)}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/* Tabellen */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl, #tblReports,
#doctorReportsTable, #doctorTable {width:100%; border-collapse:separate;
border-spacing:0 8px;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl thead th,
#tblReports thead th, #doctorReportsTable thead th {position:sticky; top:0;
background:#0f1116; z-index:1;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl th, #tbl td,
#tblReports th, #tblReports td, #doctorReportsTable th, #doctorReportsTable td,
#doctorTable th, #doctorTable td{padding:14px 12px; font-size:14px;
vertical-align:top;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl tbody tr td,
#tblReports tbody tr td, #doctorReportsTable tbody tr td, #doctorTable tbody tr
td{background:#0f1116; border-top:1px solid #2b2f3a; border-bottom:1px solid
#2b2f3a;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl tbody tr
td:first-child, #tblReports tbody tr td:first-child, #doctorReportsTable tbody
tr td:first-child, #doctorTable tbody tr td:first-child{border-left:1px solid
#2b2f3a; border-top-left-radius:12px; border-bottom-left-radius:12px;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl tbody tr
td:last-child, #tblReports tbody tr td:last-child, #doctorReportsTable tbody tr
td:last-child, #doctorTable tbody tr td:last-child{border-right:1px solid
#2b2f3a; border-top-right-radius:12px; border-bottom-right-radius:12px;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl td.center, #tbl
th.center, #tblReports td.center, #tblReports th.center, #doctorReportsTable
td.center, #doctorReportsTable th.center, #doctorTable td.center, #doctorTable
th.center{ text-align:center; white-space:nowrap; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl td.nowrap, #tbl
th.nowrap, #tblReports td.nowrap, #tblReports th.nowrap, #doctorReportsTable
td.nowrap, #doctorReportsTable th.nowrap{ white-space:nowrap; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#tbl td.notes,
#tblReports td.notes, #doctorReportsTable td.notes{ max-width: 680px;
white-space: normal; word-break: break-word; overflow-wrap:anywhere;
line-height:1.4; }<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.blockTitle{font-weight:800;margin:0 0 8px 0}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/* Chart panel */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#chart .controls,
#chartReports
.controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:8px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#chart .controls
&gt; *, #chartReports .controls &gt; * {flex:1}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#chart .controls
.half, #chartReports .controls .half{flex:0 0 calc(50% - 4px)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#chart svg,
#chartReports
svg{width:100%;height:260px;display:block;background:#0f1116;border:1px solid
#2b2f3a;border-radius:10px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#chart .legend,
#chartReports
.legend{display:flex;gap:10px;font-size:12px;color:var(--muted);margin-top:6px;flex-wrap:wrap}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.dot{width:8px;height:8px;border-radius:50%;display:inline-block;margin-right:6px;border:1px
solid #000}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/* Busy overlay */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>#busy{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);z-index:99998}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>#busy
.box{background:#10131a;border:1px solid
#2b2f3a;border-radius:12px;padding:12px 16px;font-weight:600}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.seg{display:flex;gap:8px;margin:8px 0 12px}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.seg
.seg-btn.active{background:var(--accent);color:#fff}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.hidden{display:none!important}<o:p></o:p></p>

<p class=MsoNormal>&lt;/style&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/head&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;body&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;display:flex;align-items:center;gap:10px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;h1&gt;Gesundheits-Logger&lt;/h1&gt;&lt;span
class=&quot;small&quot;&gt;V1.0&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;spacer&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;helpToggle&quot;
type=&quot;button&quot;&gt;Hilfe&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;diagToggle&quot;
type=&quot;button&quot;&gt;Log&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/header&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;nav class=&quot;tabs&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; data-tab=&quot;capture&quot;
id=&quot;tab-capture&quot; type=&quot;button&quot;&gt;Erfassen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; data-tab=&quot;list&quot; id=&quot;tab-list&quot;
type=&quot;button&quot;&gt;Liste&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; data-tab=&quot;doctor&quot;
id=&quot;tab-doctor&quot;
type=&quot;button&quot;&gt;Arzt-Ansicht&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/nav&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;!-- Hilfe-Panel --&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;div id=&quot;help&quot; class=&quot;panel&quot;
role=&quot;dialog&quot; aria-modal=&quot;false&quot;
aria-labelledby=&quot;helpTitle&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h4
id=&quot;helpTitle&quot;&gt;Hilfe  Was soll ich ankreuzen?&lt;/h4&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;helpClose&quot;
type=&quot;button&quot;&gt;&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;content&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;strong&gt;NSAR
genommen&lt;/strong&gt; ankreuzen, wenn du ein Schmerz-/Entzndungsmedikament
der Klasse NSAR genommen hast.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;ul&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;li&gt;&lt;em&gt;Beispiele (AT, frei):&lt;/em&gt; Ibuprofen,
Diclofenac, Naproxen.&lt;/li&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;li&gt;&lt;em&gt;Kombo-Achtung:&lt;/em&gt; Viele
Erkltungs-/Kopfweh-Mittel enthalten NSAR.&lt;/li&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;li&gt;&lt;em&gt;Bei Nierenkrankheit:&lt;/em&gt; NSAR mglichst
vermeiden, Alternativen mit Arzt besprechen.&lt;/li&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/ul&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;!-- Diagnose-Panel --&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;div id=&quot;diag&quot; class=&quot;panel&quot;
role=&quot;dialog&quot; aria-modal=&quot;false&quot;
aria-labelledby=&quot;diagTitle&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h4
id=&quot;diagTitle&quot;&gt;Touch-Log&lt;/h4&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;diagClose&quot;
type=&quot;button&quot;&gt;&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;pre
id=&quot;diagLog&quot; class=&quot;content&quot;
style=&quot;margin:0&quot;&gt;&lt;/pre&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;!-- Diagramm-Panel (Daily) --&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;div id=&quot;chart&quot; class=&quot;panel&quot;
role=&quot;dialog&quot; aria-modal=&quot;false&quot;
aria-labelledby=&quot;chartTitle&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h4
id=&quot;chartTitle&quot;&gt;Diagramm (Daily)&lt;/h4&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;chartClose&quot;
type=&quot;button&quot;&gt;&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;content&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;controls&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;select
id=&quot;metricSel&quot; class=&quot;half&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;bp&quot;&gt;Blutdruck (Sys/Dia)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;pulse&quot;&gt;Puls&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;weight&quot;&gt;Gewicht&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/select&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;label
class=&quot;half&quot;
style=&quot;display:flex;align-items:center;gap:8px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;input
type=&quot;checkbox&quot; id=&quot;smoothChk&quot;&gt; Gltten<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost half&quot; id=&quot;refreshChart&quot;
type=&quot;button&quot;&gt;Neu zeichnen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost half&quot; id=&quot;savePng&quot;
type=&quot;button&quot;&gt;PNG speichern&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;svg
id=&quot;chartSvg&quot; viewBox=&quot;0 0 640 280&quot;
preserveAspectRatio=&quot;none&quot; role=&quot;img&quot;
aria-label=&quot;Werteverlauf&quot;&gt;&lt;/svg&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;legend&quot; id=&quot;chartLegend&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;small&quot;
style=&quot;opacity:.7;margin-top:6px&quot;&gt;Zeitraum: nutzt die
&lt;em&gt;Arzt-Ansicht&lt;/em&gt; (von/bis).&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;!-- Diagramm-Panel (Befunde) --&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;div id=&quot;chartReports&quot; class=&quot;panel&quot;
role=&quot;dialog&quot; aria-modal=&quot;false&quot;
aria-labelledby=&quot;chartReportsTitle&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h4
id=&quot;chartReportsTitle&quot;&gt;Diagramm (Befunde)&lt;/h4&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;chartReportsClose&quot;
type=&quot;button&quot;&gt;&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/header&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;content&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;controls&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;select id=&quot;reportMetricSel&quot;
class=&quot;half&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;kreatinin&quot;&gt;Kreatinin (mg/dL)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;egfr&quot;&gt;eGFR (ml/min/1.73m)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;uacr&quot;&gt;uACR (mg/g)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;kalium&quot;&gt;Kalium (mmol/L)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;cystatin_c&quot;&gt;Cystatin C (mg/L)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;haematurie&quot;&gt;Hmaturie (Ery/L)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;ldl&quot;&gt;LDL (mg/dL)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;hba1c&quot;&gt;HbA1c (%)&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/select&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;label
class=&quot;half&quot;
style=&quot;display:flex;align-items:center;gap:8px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;input
type=&quot;checkbox&quot; id=&quot;reportSmoothChk&quot;&gt; Gltten<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost half&quot; id=&quot;refreshReportChart&quot;
type=&quot;button&quot;&gt;Neu zeichnen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost half&quot; id=&quot;saveReportPng&quot;
type=&quot;button&quot;&gt;PNG speichern&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;svg
id=&quot;chartReportsSvg&quot; viewBox=&quot;0 0 640 280&quot;
preserveAspectRatio=&quot;none&quot; role=&quot;img&quot;
aria-label=&quot;Befund-Verlauf&quot;&gt;&lt;/svg&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;legend&quot; id=&quot;chartReportsLegend&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;small&quot;
style=&quot;opacity:.7;margin-top:6px&quot;&gt;Zeitraum: nutzt die
&lt;em&gt;Arzt-Ansicht&lt;/em&gt; (von/bis).&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;div id=&quot;err&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;div id=&quot;busy&quot;&gt;&lt;div
class=&quot;box&quot;&gt;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#9203;</span> Bitte warten<span
style='mso-ascii-font-family:Aptos;mso-hansi-font-family:Aptos;mso-bidi-font-family:
Aptos'></span>&lt;/div&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;main&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!-- Capture
--&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;view active&quot; id=&quot;capture&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;seg&quot; id=&quot;seg-capture&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost seg-btn active&quot;
data-mode=&quot;daily&quot;&gt;Erfassen  Daily&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost seg-btn&quot; data-mode=&quot;befund&quot;&gt;Erfassen 
Befund&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!--
Daily-Capture --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;card&quot; id=&quot;entry&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;flex:1&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;label&gt;Datum&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;input
type=&quot;date&quot; id=&quot;date&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;card&quot; style=&quot;margin:8px
0;background:#11131a;border-color:#232735&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3
class=&quot;blockTitle&quot;&gt;Morgens&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;width:130px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;label&gt;Uhrzeit&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;input
type=&quot;time&quot; id=&quot;timeM&quot; step=&quot;60&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;grid&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Systolisch (mmHg)&lt;/label&gt;&lt;input
type=&quot;number&quot; id=&quot;sysM&quot; inputmode=&quot;numeric&quot;
placeholder=&quot;z. B. 128&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Diastolisch (mmHg)&lt;/label&gt;&lt;input
type=&quot;number&quot; id=&quot;diaM&quot; inputmode=&quot;numeric&quot;
placeholder=&quot;z. B. 82&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Puls (bpm)&lt;/label&gt;&lt;input
type=&quot;number&quot; id=&quot;pulseM&quot; inputmode=&quot;numeric&quot;
placeholder=&quot;z. B. 66&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;card&quot; style=&quot;margin:8px
0;background:#11131a;border-color:#232735&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3
class=&quot;blockTitle&quot;&gt;Abends&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;width:130px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;label&gt;Uhrzeit&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;input
type=&quot;time&quot; id=&quot;timeA&quot; step=&quot;60&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;grid&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Systolisch (mmHg)&lt;/label&gt;&lt;input
type=&quot;number&quot; id=&quot;sysA&quot; inputmode=&quot;numeric&quot;
placeholder=&quot;z. B. 128&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Diastolisch (mmHg)&lt;/label&gt;&lt;input
type=&quot;number&quot; id=&quot;diaA&quot; inputmode=&quot;numeric&quot;
placeholder=&quot;z. B. 82&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Puls (bpm)&lt;/label&gt;&lt;input
type=&quot;number&quot; id=&quot;pulseA&quot; inputmode=&quot;numeric&quot;
placeholder=&quot;z. B. 66&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;card&quot; style=&quot;margin:8px
0;background:#11131a;border-color:#232735&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3
class=&quot;blockTitle&quot;&gt;Gewicht&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;flex:1&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;label&gt;Gewicht (kg)&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;input
type=&quot;number&quot; step=&quot;0.1&quot; id=&quot;weightDay&quot;
inputmode=&quot;decimal&quot; placeholder=&quot;z. B. 84.2&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;card&quot; style=&quot;margin:8px
0;background:#11131a;border-color:#232735&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3
class=&quot;blockTitle&quot;&gt;Kommentar&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;flex:1&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;textarea id=&quot;notesDay&quot; placeholder=&quot;Allgemeiner
Kommentar zum Tag (optional)&quot;&gt;&lt;/textarea&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot; style=&quot;align-items:center; gap:8px;
margin-top:4px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn toggle&quot; id=&quot;trainingToggle&quot;
type=&quot;button&quot; aria-pressed=&quot;false&quot;&gt;<span
style='font-family:"Segoe UI Symbol",sans-serif;mso-bidi-font-family:"Segoe UI Symbol"'>&#127947;</span>
Training heute&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn toggle&quot; id=&quot;sickToggle&quot; type=&quot;button&quot;
aria-pressed=&quot;false&quot;&gt;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#129298;</span> Krank (Forxiga
pausiert)&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn toggle&quot; id=&quot;valsartanMissToggle&quot;
type=&quot;button&quot; aria-pressed=&quot;false&quot;&gt;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#128138;</span>
Valsartan vergessen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn toggle&quot; id=&quot;forxigaMissToggle&quot;
type=&quot;button&quot; aria-pressed=&quot;false&quot;&gt;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#128138;</span>
Forxiga vergessen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn toggle&quot; id=&quot;lowIntakeToggle&quot;
type=&quot;button&quot; aria-pressed=&quot;false&quot;&gt;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#129380;</span>
&amp;lt; 2 L getrunken&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn toggle&quot; id=&quot;nsarToggle&quot; type=&quot;button&quot;
aria-pressed=&quot;false&quot; title=&quot;Nicht-steroidale
Antirheumatika&quot;&gt;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#129514;</span> NSAR
genommen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;spacer&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot; style=&quot;align-items:center; gap:8px;
margin-top:12px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn primary&quot; id=&quot;saveAllBtn&quot;
type=&quot;button&quot;&gt;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#128190;</span>
Speichern&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;spacer&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!--
Befund-Capture --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;card hidden&quot; id=&quot;entry_befund&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3
class=&quot;blockTitle&quot;&gt;Neuer Befund&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;grid&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Datum&lt;/label&gt;&lt;input
type=&quot;date&quot; id=&quot;repDate&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Kreatinin (mg/dL)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;0.01&quot;
id=&quot;repKrea&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;eGFR (ml/min/1.73m)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;1&quot;
id=&quot;repEgfr&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;uACR (mg/g)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;1&quot;
id=&quot;repUacr&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Kalium (mmol/L)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;0.1&quot;
id=&quot;repK&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Cystatin C (mg/L)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;0.01&quot;
id=&quot;repCys&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Hmaturie (Ery/L)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;1&quot;
id=&quot;repHaem&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;LDL (mg/dL)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;1&quot;
id=&quot;repLDL&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;HbA1c (%)&lt;/label&gt;&lt;input
type=&quot;number&quot; step=&quot;0.1&quot;
id=&quot;repHbA1c&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Kommentar&lt;/label&gt;&lt;input
type=&quot;text&quot; id=&quot;repNote&quot; placeholder=&quot;Labor /
Kontext&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot; style=&quot;align-items:center; gap:8px;
margin-top:12px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn primary&quot; id=&quot;saveReportBtn&quot;
type=&quot;button&quot;&gt;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#128190;</span> Befund
speichern&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;spacer&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!-- List --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;view&quot; id=&quot;list&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;card&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;toolbar&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;strong&gt;Deine Eintrge (Bearbeiten/Export)&lt;/strong&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;spacer&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;select
id=&quot;rangeSel&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;all&quot;&gt;alle&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;7&quot;&gt;letzte 7 Tage&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;30&quot;&gt;letzte 30 Tage&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option
value=&quot;90&quot;&gt;letzte 90 Tage&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/select&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;exportCsv&quot;
type=&quot;button&quot;&gt;Export CSV&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;exportJson&quot;
type=&quot;button&quot;&gt;Export JSON&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;syncBtn&quot; type=&quot;button&quot;
title=&quot;Sicherung + Neu laden von Supabase&quot;&gt;&#8597; Sync
(Daily)&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn warn&quot; id=&quot;wipeBtn&quot; type=&quot;button&quot;
title=&quot;Nur auf diesem Gert&quot;&gt;Alle lokal lschen
(Daily)&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;seg&quot; id=&quot;seg-list&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost seg-btn active&quot; data-mode=&quot;daily&quot;&gt;Liste
 Daily&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost seg-btn&quot; data-mode=&quot;befund&quot;&gt;Liste 
Befunde&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!-- Wrapper
Daily --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;overflow:auto&quot; id=&quot;listDailyWrap&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;table
id=&quot;tbl&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;thead&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;nowrap&quot;&gt;Datum&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;nowrap&quot;&gt;Zeit&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Art&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Syst&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Diast&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Puls&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Gewicht&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;MAP&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Notizen&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Training&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;&amp;lt; 2 L&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Krank&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Valsartan <span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#10060;</span>&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;Forxiga <span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#10060;</span>&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot;&gt;NSAR&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center nowrap&quot; title=&quot;Mit Server
synchronisiert?&quot;&gt;Cloud&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Aktion&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/thead&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;tbody&gt;&lt;/tbody&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/table&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!-- Wrapper
Befunde --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;overflow:auto&quot; id=&quot;listReportWrap&quot;
class=&quot;hidden&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;table
id=&quot;tblReports&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;thead&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;nowrap&quot;&gt;Datum&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Kreatinin&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;eGFR&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;uACR&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Kalium&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Cystatin&amp;nbsp;C&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Hmaturie&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;LDL&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;HbA1c&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Kommentar&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Cloud&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;nowrap&quot;&gt;Aktion&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/thead&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;tbody&gt;&lt;/tbody&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/table&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;small&quot; style=&quot;margin-top:6px&quot;&gt;Dies ist deine
Arbeitsliste. Die Arzt-Ansicht ist separat und druckfertig.&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!--
Webhook-Konfiguration --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;card&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3
class=&quot;blockTitle&quot;&gt;Webhook / Supabase (Konfiguration)&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;grid&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Webhook URL
(health_entries)&lt;/label&gt;&lt;input type=&quot;url&quot;
id=&quot;whUrl&quot;
placeholder=&quot;https://XYZ.supabase.co/rest/v1/health_entries&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;API Key (Bearer)&lt;/label&gt;&lt;input
type=&quot;text&quot; id=&quot;whKey&quot; placeholder=&quot;Bearer
ey...&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div&gt;&lt;label&gt;Webhook URL
(medical_reports)&lt;/label&gt;&lt;input type=&quot;url&quot;
id=&quot;whUrlMr&quot;
placeholder=&quot;https://XYZ.supabase.co/rest/v1/medical_reports&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;row&quot; style=&quot;margin-top:8px;align-items:center&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn primary&quot; id=&quot;saveWebhook&quot;
type=&quot;button&quot;&gt;Speichern&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span
id=&quot;whSaved&quot; class=&quot;small&quot;
style=&quot;margin-left:8px&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;spacer&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;chartBtn&quot;
type=&quot;button&quot;&gt;Diagramm ffnen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!-- Doctor
--&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;view&quot; id=&quot;doctor&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;section
class=&quot;card&quot; id=&quot;doctorCard&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;toolbar&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;strong
id=&quot;doctorTitle&quot;&gt;Arzt-Ansicht&lt;/strong&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;spacer&quot;&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;seg&quot; id=&quot;seg-doctor&quot; style=&quot;margin:0&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost seg-btn active&quot;
data-mode=&quot;daily&quot;&gt;Daily&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost seg-btn&quot;
data-mode=&quot;befund&quot;&gt;Befunde&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;label
class=&quot;small&quot;&gt;Von &lt;input type=&quot;date&quot;
id=&quot;from&quot; style=&quot;width:auto&quot;&gt;&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;label
class=&quot;small&quot;&gt;Bis &lt;input type=&quot;date&quot;
id=&quot;to&quot; style=&quot;width:auto&quot;&gt;&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;applyRange&quot;
type=&quot;button&quot;&gt;Anwenden&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;doctorChartBtn&quot;
type=&quot;button&quot; title=&quot;Werte als Grafik&quot;&gt;Werte
anzeigen&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;printBtn&quot;
type=&quot;button&quot;&gt;Drucken&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;overflow:auto&quot; id=&quot;doctorDailyWrap&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;table
id=&quot;doctorTable&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;thead&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Datum&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Zeit&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Art&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Sys&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Dia&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Puls&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;MAP&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Gewicht&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Notizen&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;&amp;lt; 2 L&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Krank&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Valsartan <span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#10060;</span>&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Forxiga <span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#10060;</span>&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;NSAR&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/thead&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;tbody&gt;&lt;/tbody&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/table&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
style=&quot;overflow:auto&quot; id=&quot;doctorReportWrap&quot;
class=&quot;hidden&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;table
id=&quot;doctorReportsTable&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;thead&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Datum&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Kreatinin&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;eGFR&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;uACR&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Kalium&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Cystatin&amp;nbsp;C&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;Hmaturie&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;LDL&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;th
class=&quot;center&quot;&gt;HbA1c&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;th&gt;Kommentar&lt;/th&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/thead&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;tbody&gt;&lt;/tbody&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/table&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;small&quot; style=&quot;margin-top:6px&quot;&gt;Tipp: Werte
anzeigen ffnet die passende Grafik zum aktuellen Tab (Daily oder
Befunde).&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/section&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/main&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;div class=&quot;fab-wrap&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;fab&quot; id=&quot;helpToggleFab&quot; title=&quot;Hilfe&quot;&gt;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#10067;</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
class=&quot;fab&quot; id=&quot;diagToggleFab&quot; title=&quot;Log&quot;&gt;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#129514;</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;!-- Supabase (UMD, v2) --&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;script
src=&quot;https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js&quot;&gt;&lt;/script&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>&lt;script&gt;<o:p></o:p></p>

<p class=MsoNormal>/* ===== Fehlerbox ===== */<o:p></o:p></p>

<p class=MsoNormal>window.addEventListener('unhandledrejection', (e)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const box =
document.getElementById('err');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>box.style.display='block';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>box.textContent =
'Fehler: ' + (e.reason?.message || e.reason || 'Unbekannter Fehler');<o:p></o:p></p>

<p class=MsoNormal>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Diagnostics ===== */<o:p></o:p></p>

<p class=MsoNormal>const diag = { el:null, logEl:null, open:false, lines:[],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>add(msg){ const
t=new Date().toLocaleTimeString(); this.lines.unshift(`[${t}] ${msg}`);
this.lines=this.lines.slice(0,80); if(this.logEl) this.logEl.textContent =
this.lines.join('\n'); },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>init(){
this.el=document.getElementById('diag');
this.logEl=document.getElementById('diagLog');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
t1=document.getElementById('diagToggle'); const
t2=document.getElementById('diagToggleFab');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
close=document.getElementById('diagClose');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
toggle=()=&gt;{ this.open=!this.open;
this.el.style.display=this.open?'block':'none'; };<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>t1.addEventListener('click', toggle);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>t2.addEventListener('click', toggle);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>close.addEventListener('click', ()=&gt;{ this.open=false;
this.el.style.display='none'; });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Help panel ===== */<o:p></o:p></p>

<p class=MsoNormal>const helpPanel={ el:null, open:false,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>init(){
this.el=document.getElementById('help');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
t1=document.getElementById('helpToggle'); const
t2=document.getElementById('helpToggleFab'); const
close=document.getElementById('helpClose');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
toggle=()=&gt;{ this.open=!this.open;
this.el.style.display=this.open?'block':'none'; };<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>t1.addEventListener('click', toggle);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>t2.addEventListener('click', toggle);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>close.addEventListener('click', ()=&gt;{ this.open=false;
this.el.style.display='none'; });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Helpers ===== */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/* ===== Auth-Guard
===== */<o:p></o:p></p>

<p class=MsoNormal>async function isLoggedIn(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!sbClient)
return false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const { data:{
session } } = await sbClient.auth.getSession();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return !!session;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch{ return
false; }<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/** Schaltet die komplette App frei/zu (auer
Hilfe/Log/Google-Login) */<o:p></o:p></p>

<p class=MsoNormal>function setAuthGuard(logged){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const disabled =
!logged;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const allowIds = new
Set(['googleLoginBtn','helpToggle','diagToggle','helpToggleFab','diagToggleFab']);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// alles im
&lt;main&gt; sperren/freigeben<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>document.querySelectorAll('main input, main select, main textarea, main
button').forEach(el=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(allowIds.has(el.id)) return;<span
style='mso-spacerun:yes'> </span>// Hilfe/Log &amp; Login immer
bedienbar<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(el.id ===
'logoutBtn') return;<span style='mso-spacerun:yes'> </span>//
Abmelden bleibt klickbar, sobald sichtbar<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>el.disabled =
disabled;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Tabs sperren<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>document.querySelectorAll('nav.tabs button').forEach(b=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(allowIds.has(b.id)) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>b.disabled =
disabled;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// optisches
Feedback (optional)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>document.body.classList.toggle('auth-locked', disabled);<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const $ = sel =&gt; document.querySelector(sel);<o:p></o:p></p>

<p class=MsoNormal>const $$ = sel =&gt;
Array.from(document.querySelectorAll(sel));<o:p></o:p></p>

<p class=MsoNormal>const fmtNum = (n, d=1) =&gt;
(n===null||n===undefined||isNaN(n)) ? &quot;&quot; : Number(n).toFixed(d);<o:p></o:p></p>

<p class=MsoNormal>const pad2 = n =&gt; n.toString().padStart(2,'0');<o:p></o:p></p>

<p class=MsoNormal>const todayStr = () =&gt; { const d = new Date(); const
y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'),
day=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${day}`; };<o:p></o:p></p>

<p class=MsoNormal>const timeStr = () =&gt; { const d = new Date(); return
pad2(d.getHours())+&quot;:&quot;+pad2(d.getMinutes()); };<o:p></o:p></p>

<p class=MsoNormal>function esc(s){ return
String(s).replace(/[&amp;&lt;&gt;\&quot;']/g, c =&gt;
({'&amp;':'&amp;amp;','&lt;':'&amp;lt;','&gt;':'&amp;gt;','&quot;':'&amp;quot;',&quot;'&quot;:'&amp;#39;'}[c]));
}<o:p></o:p></p>

<p class=MsoNormal>function nl2br(s){ return esc(s).replace(/\n/g,
&quot;&lt;br&gt;&quot;); }<o:p></o:p></p>

<p class=MsoNormal>function calcMAP(sys, dia){ if (sys==null || dia==null)
return null; return Number(dia) + (Number(sys)-Number(dia))/3; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'></span>function setBusy(on){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>document.body.classList.toggle('is-busy', !!on);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const b =
document.getElementById('busy');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (b)
b.style.display = on ? 'flex' : 'none';<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function sleep(ms){ return new
Promise(r=&gt;setTimeout(r,ms)); }<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
softWarnRange(el, min, max){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const v =
Number(el.value);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (!isNaN(v)
&amp;&amp; (v &lt; min || v &gt; max)) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>el.style.outline =
'2px solid var(--warn)';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>el.style.outline =
'';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== IndexedDB ===== */<o:p></o:p></p>

<p class=MsoNormal>let db;<o:p></o:p></p>

<p class=MsoNormal>const DB_NAME=&quot;healthlog_db&quot;; const
STORE=&quot;entries&quot;; const CONF=&quot;config&quot;;<o:p></o:p></p>

<p class=MsoNormal>function initDB(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((resolve,reject)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Bump: Version 4
 Indizes fr remote_id (Entries &amp; Reports)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
indexedDB.open(DB_NAME, 4);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>req.onupgradeneeded = (e)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const db =
e.target.result;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// entries<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!db.objectStoreNames.contains(STORE)){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const s =
db.createObjectStore(STORE,{keyPath:&quot;id&quot;,autoIncrement:true});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>s.createIndex(&quot;byDateTime&quot;,&quot;dateTime&quot;,{unique:false});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>s.createIndex(&quot;byRemote&quot;,&quot;remote_id&quot;,{unique:false});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const s =
e.target.transaction.objectStore(STORE);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{
s.createIndex(&quot;byDateTime&quot;,&quot;dateTime&quot;,{unique:false});
}catch(_){}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{
s.createIndex(&quot;byRemote&quot;,&quot;remote_id&quot;,{unique:false});
}catch(_){}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// config<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!db.objectStoreNames.contains(CONF)){
db.createObjectStore(CONF,{keyPath:&quot;key&quot;}); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// reports<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!db.objectStoreNames.contains(&quot;reports&quot;)){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const r =
db.createObjectStore(&quot;reports&quot;,{keyPath:&quot;id&quot;,autoIncrement:true});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>r.createIndex(&quot;byDate&quot;,&quot;datum&quot;,{unique:false});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>r.createIndex(&quot;byRemote&quot;,&quot;remote_id&quot;,{unique:false});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const r =
e.target.transaction.objectStore(&quot;reports&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{
r.createIndex(&quot;byDate&quot;,&quot;datum&quot;,{unique:false}); }catch(_){}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{
r.createIndex(&quot;byRemote&quot;,&quot;remote_id&quot;,{unique:false});
}catch(_){}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
(e)=&gt;{ db = e.target.result; resolve(); };<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; reject(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function putConf(key, value){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(CONF, &quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tx.objectStore(CONF).put({key, value});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.oncomplete =
()=&gt;res();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.onerror =
(e)=&gt;rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function getConf(key){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(CONF, &quot;readonly&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
tx.objectStore(CONF).get(key);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
()=&gt; res(req.result?.value ?? null);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function addEntry(obj){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(STORE,&quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
tx.objectStore(STORE).add(obj);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
()=&gt; res(req.result);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function updateEntry(id, patch){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(STORE,&quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const store =
tx.objectStore(STORE);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const getReq =
store.get(id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>getReq.onsuccess =
()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const cur =
getReq.result; if(!cur){ res(false); return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const next =
Object.assign({}, cur, patch);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>store.put(next);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.oncomplete =
()=&gt;res(true);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.onerror =
(e)=&gt;rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function getAllEntries(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(STORE,&quot;readonly&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
tx.objectStore(STORE).getAll();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
()=&gt; res(req.result || []);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function getEntryByRemoteId(remoteId){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(STORE,&quot;readonly&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const idx =
tx.objectStore(STORE).index(&quot;byRemote&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
idx.getAll(remoteId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
()=&gt; res(req.result?.[0] ?? null);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function deleteEntryLocal(id){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(STORE,&quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tx.objectStore(STORE).delete(id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.oncomplete =
()=&gt;res();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.onerror =
(e)=&gt;rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function wipeAll(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(STORE,&quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tx.objectStore(STORE).clear();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.oncomplete =
()=&gt;res();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.onerror =
(e)=&gt;rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Reports (Befunde) ===== */<o:p></o:p></p>

<p class=MsoNormal>function addReport(obj){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(&quot;reports&quot;,&quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
tx.objectStore(&quot;reports&quot;).add(obj);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
()=&gt; res(req.result);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function updateReport(id, patch){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(&quot;reports&quot;,&quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const store =
tx.objectStore(&quot;reports&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const getReq =
store.get(id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>getReq.onsuccess =
()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const cur =
getReq.result; if(!cur){ res(false); return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>store.put(Object.assign({}, cur, patch));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.oncomplete =
()=&gt;res(true);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.onerror =
(e)=&gt;rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function getAllReports(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(&quot;reports&quot;,&quot;readonly&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
tx.objectStore(&quot;reports&quot;).getAll();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
()=&gt; res(req.result || []);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function getReportByRemoteId(remoteId){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(&quot;reports&quot;,&quot;readonly&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const idx =
tx.objectStore(&quot;reports&quot;).index(&quot;byRemote&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const req =
idx.getAll(remoteId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onsuccess =
()=&gt; res(req.result?.[0] ?? null);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>req.onerror =
(e)=&gt; rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function deleteReportLocal(id){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return new
Promise((res,rej)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tx =
db.transaction(&quot;reports&quot;,&quot;readwrite&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tx.objectStore(&quot;reports&quot;).delete(id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.oncomplete =
()=&gt;res();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tx.onerror =
(e)=&gt;rej(e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Remote (Supabase REST) ===== */<o:p></o:p></p>

<p class=MsoNormal>async function getHeaders(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// anonKey aus der
Konfiguration<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const key = await
getConf(&quot;webhookKey&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const anonKey =
key?.replace(/^Bearer\s+/i, &quot;&quot;);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Supabase-Client
sicherstellen<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const supa = await
ensureSupabaseClient();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (!supa) return
null;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Session (Google
Login) holen<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const { data: {
session } } = await supa.auth.getSession();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const jwt =
session?.access_token;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (!anonKey ||
!jwt) return null;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&quot;Content-Type&quot;: &quot;application/json&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&quot;apikey&quot;: anonKey,<span
style='mso-spacerun:yes'> </span>// braucht Supabase REST<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&quot;Authorization&quot;: `Bearer ${jwt}`, // dein Google-Login JWT<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&quot;Prefer&quot;: &quot;return=representation&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>async function deleteRemote(remote_id){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrl&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!url || !headers
|| !remote_id) return {ok:false};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const q =
`${url}?id=eq.${encodeURIComponent(remote_id)}`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const res = await
fetch(q, { method:&quot;DELETE&quot;, headers });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return {ok:
res.ok, status: res.status};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch(e){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return {ok:false,
status:0};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function deleteRemoteBefund(remote_id){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrlMr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!url || !headers
|| !remote_id) return {ok:false};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const q =
`${url}?id=eq.${encodeURIComponent(remote_id)}`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const res = await
fetch(q, { method:&quot;DELETE&quot;, headers });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return {ok:
res.ok, status: res.status};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch(e){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return {ok:false,
status:0};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function pullAllFromRemote(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrl&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!url || !headers)
throw new Error(&quot;Webhook nicht konfiguriert&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const q =
`${url}?select=*&amp;order=ts.asc`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const res = await
fetch(q, { headers });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!res.ok) throw
new Error(`Fetch fehlgeschlagen (${res.status})`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return res.json();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function pullAllReportsFromRemote(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrlMr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!url || !headers)
return [];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const q =
`${url}?select=*&amp;order=datum.asc`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const res = await
fetch(q, { headers });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!res.ok) return
[];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return res.json();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function pushPendingToRemote(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrl&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!url || !headers)
return { pushed:0, failed:0 };<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const all = await
getAllEntries();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const pending =
all.filter(e=&gt;!e.remote_id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let pushed=0,
failed=0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(const e of
pending){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const { id:
_dropLocal, remote_id: _dropRemote, ...safe } = e;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const res =
await fetch(url, { method:&quot;POST&quot;, headers, body: JSON.stringify(safe)
});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!res.ok){
failed++; continue; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const json =
await res.json();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const rid =
json?.[0]?.id;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(rid){ await
updateEntry(e.id, { remote_id: rid }); pushed++; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else { failed++;
}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await sleep(50);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch(_){
failed++; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return { pushed,
failed };<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Remote fr Befunde (POST) ===== */<o:p></o:p></p>

<p class=MsoNormal>async function syncReportWebhook(report, localId){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrlMr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!url || !headers)
return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const payload = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>datum:
report.datum,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kreatinin:
report.kreatinin ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>egfr:<span
style='mso-spacerun:yes'> </span>report.egfr ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>uacr:<span
style='mso-spacerun:yes'> </span>report.uacr ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kalium:<span
style='mso-spacerun:yes'> </span>report.kalium ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hba1c:<span
style='mso-spacerun:yes'> </span>report.hba1c ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ldl:<span
style='mso-spacerun:yes'> </span>report.ldl ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hdl:<span
style='mso-spacerun:yes'> </span>report.hdl ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>haematurie:report.haematurie ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>cystatin_c:
report.cystatin_c ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kommentar:
report.kommentar ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>source:<span
style='mso-spacerun:yes'> </span>report.source ?? &quot;manuell&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const res = await
fetch(url, { method:&quot;POST&quot;, headers, body: JSON.stringify(payload)
});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!res.ok){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const txt =
await res.text(); diag.add(`MR-POST Fehler ${res.status}: ${txt}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const json = await
res.json();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const remoteId =
json?.[0]?.id;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(remoteId){
await updateReport(localId, { remote_id: remoteId }); diag.add(&quot;Befund:
Webhook OK&quot;); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch(e){
diag.add(&quot;Befund: Netzwerkfehler&quot;); }<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function showLoginBar(show){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const bar =
document.getElementById('loginBar');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (bar)
bar.style.display = show ? 'flex' : 'none';<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function setUserUi(email){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>document.getElementById('whoAmI').textContent = email ? `Angemeldet als:
${email}` : '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>document.getElementById('logoutBtn').style.display = email ? '' :
'none';<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// Buttons binden (einmalig, z. B. in main())<o:p></o:p></p>

<p class=MsoNormal>function bindAuthButtons(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const gbtn =
document.getElementById('googleLoginBtn');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const lout =
document.getElementById('logoutBtn');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (gbtn)
gbtn.addEventListener('click', async ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const supa = await
ensureSupabaseClient();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (!supa) { <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>alert('Bitte
zuerst unter &quot;Webhook / Supabase&quot; die REST-URLs und den API-Key
speichern.');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>const { error } = await supa.auth.signInWithOAuth({<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>provider: 'google',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>options: {
redirectTo: `${window.location.origin}${window.location.pathname}` }<o:p></o:p></p>

<p class=MsoNormal>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (error)
alert('Google-Login fehlgeschlagen: ' + error.message);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (lout)
lout.addEventListener('click', async ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const supa = await
ensureSupabaseClient();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (supa) await
supa.auth.signOut();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setUserUi('');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>showLoginBar(true);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// Beim Start Session prfen<o:p></o:p></p>

<p class=MsoNormal>async function requireSession(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const { data: {
session } } = await sbClient.auth.getSession();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const email =
session?.user?.email || '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setUserUi(email);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>showLoginBar(!session);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>setAuthGuard(!!session);<span style='mso-spacerun:yes'>
</span>// &lt; NEU: UI sperren/freigeben<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return !!session;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const { data: {
session } } = await supa.auth.getSession();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const email =
session?.user?.email || '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setUserUi(email);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>showLoginBar(!session);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return !!session;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// Reagiert auch auf sptere Logins (z. B. nach Redirect)<o:p></o:p></p>

<p class=MsoNormal>function watchAuthState(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>sbClient.auth.onAuthStateChange(async (_event, session)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const email =
session?.user?.email || '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setUserUi(email);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>showLoginBar(!session);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>setAuthGuard(!!session);<span style='mso-spacerun:yes'> </span>//
&lt; NEU: UI sperren/freigeben<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(session){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
afterLoginBoot();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// Alles, was NACH Login laufen soll (deine bestehende
Logik)<o:p></o:p></p>

<p class=MsoNormal>async function afterLoginBoot(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
initialAutoSync();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
setupRealtime();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRender();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
renderDoctor();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== CSV/JSON export (Daily) ===== */<o:p></o:p></p>

<p class=MsoNormal>function toCSV(entries){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const header =
[&quot;Datum&quot;,&quot;Uhrzeit&quot;,&quot;Art&quot;,&quot;Systolisch&quot;,&quot;Diastolisch&quot;,&quot;Puls&quot;,&quot;Gewicht_kg&quot;,&quot;MAP&quot;,&quot;Notizen&quot;,&quot;Training&quot;,&quot;Unter_2L&quot;,&quot;Krank&quot;,&quot;Valsartan_vergessen&quot;,&quot;Forxiga_vergessen&quot;,&quot;NSAR_genommen&quot;,&quot;ISODateTime&quot;,&quot;ID&quot;,&quot;REMOTE_ID&quot;];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const rows =
entries.map(e=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
isTrainingOnly = e.training &amp;&amp; (!e.sys &amp;&amp; !e.dia &amp;&amp;
!e.pulse &amp;&amp; !e.weight);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const art<span
style='mso-spacerun:yes'> </span>= isTrainingOnly ? &quot;Training&quot; :
&quot;Messung&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const notes =
(isTrainingOnly ? (&quot;<span style='font-family:"Segoe UI Symbol",sans-serif;
mso-bidi-font-family:"Segoe UI Symbol"'>&#127947;</span> Training&quot; +
(e.notes ? &quot;  &quot; + e.notes : &quot;&quot;)) : (e.notes ||
&quot;&quot;)).replace(/\n/g,&quot; &quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.date, e.time,
art,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>isTrainingOnly ?
&quot;&quot; : (e.sys??&quot;&quot;),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>isTrainingOnly ?
&quot;&quot; : (e.dia??&quot;&quot;),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>isTrainingOnly ?
&quot;&quot; : (e.pulse??&quot;&quot;),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>isTrainingOnly ?
&quot;&quot; : (e.weight??&quot;&quot;),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>isTrainingOnly ?
&quot;&quot; : (e.map??&quot;&quot;),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>notes,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.training ?
&quot;Ja&quot; : &quot;&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.low_intake ?
&quot;Ja&quot; : &quot;&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.sick ?
&quot;Ja&quot;:&quot;&quot;, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>e.valsartan_missed ? &quot;Ja&quot; : &quot;&quot;, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.forxiga_missed
? &quot;Ja&quot; : &quot;&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.nsar_taken ?
&quot;Ja&quot; : &quot;&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.dateTime, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.id,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>e.remote_id ??
&quot;&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const csv = [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>header.join(&quot;,&quot;),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>...rows.map(r
=&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>r.map(v =&gt;
(typeof v === &quot;string&quot; &amp;&amp; /[&quot;,\n]/.test(v)) ? '&quot;' +
v.replace(/&quot;/g, '&quot;&quot;') + '&quot;' : v)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>].join(&quot;\n&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return csv;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function dl(filename, content, mime){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const a =
document.createElement(&quot;a&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.href =
URL.createObjectURL(new Blob([content], {type:mime}));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.download =
filename;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.click();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(a.href);<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== List rendering (Daily) ===== */<o:p></o:p></p>

<p class=MsoNormal>function withinDays(dateISO, days){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if
(days===&quot;all&quot;) return true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const d = new
Date(dateISO+&quot;T00:00:00&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const now = new
Date(); const diff = (now - d)/(1000*60*60*24);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return diff &lt;=
Number(days);<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function compareForList(a, b){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (a.date !==
b.date) return a.date &lt; b.date ? 1 : -1;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (a.time &lt;
b.time) return -1;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (a.time &gt;
b.time) return 1;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return 0;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function renderTable(entries){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const days =
$(&quot;#rangeSel&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tbody =
$(&quot;#tbl tbody&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tbody.innerHTML =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>entries<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.filter(e=&gt;withinDays(e.date, days))<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.sort(compareForList)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.forEach(e=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
isTrainingOnly = e.training &amp;&amp; (!e.sys &amp;&amp; !e.dia &amp;&amp;
!e.pulse &amp;&amp; !e.weight);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const art =
isTrainingOnly ? &quot;Training&quot; : &quot;Messung&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const notesText
= isTrainingOnly ? (&quot;<span style='font-family:"Segoe UI Symbol",sans-serif;
mso-bidi-font-family:"Segoe UI Symbol"'>&#127947;</span> Training&quot; +
(e.notes ? &quot;  &quot; + e.notes : &quot;&quot;)) :
(e.notes||&quot;&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const zeitLabel
= e.context === &quot;Morgen&quot; ? `${e.time} (Morgens)` : e.context ===
&quot;Abend&quot; ? `${e.time} (Abends)` : e.time;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const synced =
e.remote_id ? &quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#9729;&#65039;</span>&quot; :
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tr =
document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tr.innerHTML = `<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;nowrap&quot;&gt;${e.date}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;nowrap&quot;&gt;${zeitLabel}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${art}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${isTrainingOnly ? &quot;&quot; :
(e.sys??&quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${isTrainingOnly ? &quot;&quot; :
(e.dia??&quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${isTrainingOnly ? &quot;&quot; :
(e.pulse??&quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${isTrainingOnly ? &quot;&quot; :
fmtNum(e.weight)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${isTrainingOnly ? &quot;&quot; :
fmtNum(e.map)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;notes&quot;&gt;${nl2br(notesText)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${e.training ? &quot;Ja&quot; :
&quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${e.low_intake ? &quot;Ja&quot; :
&quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${e.sick ? &quot;Ja&quot; :
&quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${e.valsartan_missed ? &quot;Ja&quot; :
&quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${e.forxiga_missed ? &quot;Ja&quot; :
&quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${e.nsar_taken ? &quot;Ja&quot; :
&quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${synced}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;&lt;button class=&quot;btn ghost&quot;
data-del=&quot;${e.id}&quot; data-remote=&quot;${e.remote_id ??
''}&quot;&gt;Lschen&lt;/button&gt;&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if
(!tbody.children.length) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tr =
document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tr.innerHTML =
`&lt;td colspan=&quot;17&quot; class=&quot;small&quot;
style=&quot;text-align:center;opacity:.7&quot;&gt;Keine Eintrge im
ausgewhlten Zeitraum&lt;/td&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>$$(&quot;#tbl
[data-del]&quot;).forEach(btn=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>btn.addEventListener(&quot;click&quot;, async ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const localId =
Number(btn.dataset.del);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const remoteId =
btn.dataset.remote || &quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!confirm(&quot;Eintrag wirklich lschen? (falls vorhanden, auch in
Supabase)&quot;)) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>btn.disabled =
true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const oldText =
btn.textContent;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>btn.textContent
= &quot;Lsche&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(remoteId){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const r =
await deleteRemote(remoteId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!r.ok){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>alert(&quot;Server-Lschung fehlgeschlagen
(&quot;+(r.status||&quot;?&quot;)+&quot;)  lokaler Eintrag wird NICHT
gelscht.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
deleteEntryLocal(localId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRender();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
renderDoctor();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartPanel.open) chartPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(remoteId ? &quot;Lschung: Server + lokal OK&quot; :
&quot;Lschung: lokal OK&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} finally {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>btn.textContent = oldText;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>btn.disabled =
false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function loadAndRender(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const entries =
await getAllEntries();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>renderTable(entries);<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== List rendering (Befunde) ===== */<o:p></o:p></p>

<p class=MsoNormal>async function loadAndRenderReports(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const reports =
await getAllReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tbody =
$(&quot;#tblReports tbody&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tbody.innerHTML =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>reports<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.sort((a,b)=&gt;
(b.ts ?? new Date(b.datum).getTime()) - (a.ts ?? new Date(a.datum).getTime()))<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.forEach(r=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const synced =
r.remote_id ? &quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#9729;&#65039;</span>&quot; :
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tr =
document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal>tr.innerHTML = `<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;nowrap&quot;&gt;${r.datum || &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.kreatinin<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.kreatinin).toFixed(2) : &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.egfr<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.egfr).toFixed(0)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.uacr<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.uacr).toFixed(0)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.kalium<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.kalium).toFixed(1)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.cystatin_c != null ?
Number(r.cystatin_c).toFixed(2): &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.haematurie != null ?
Number(r.haematurie).toFixed(0): &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.ldl<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.ldl).toFixed(0)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.hba1c<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.hba1c).toFixed(1)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;notes&quot;&gt;${nl2br(r.kommentar || &quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${synced}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td&gt;&lt;button
class=&quot;btn ghost&quot; data-delrep=&quot;${r.id}&quot;
data-remote=&quot;${r.remote_id ??
''}&quot;&gt;Lschen&lt;/button&gt;&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal>`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!tbody.children.length){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
tr=document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tr.innerHTML=`&lt;td colspan=&quot;12&quot; class=&quot;small&quot;
style=&quot;text-align:center;opacity:.7&quot;&gt;Keine Befunde
vorhanden&lt;/td&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>$$(&quot;#tblReports
[data-delrep]&quot;).forEach(btn=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>btn.addEventListener(&quot;click&quot;, async ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const localId =
Number(btn.dataset.delrep);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const remoteId =
btn.dataset.remote || &quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!confirm(&quot;Befund wirklich lschen? (falls vorhanden, auch in
Supabase)&quot;)) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>btn.disabled =
true; const old=btn.textContent; btn.textContent = &quot;Lsche&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(remoteId){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const r =
await deleteRemoteBefund(remoteId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!r.ok){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>alert(&quot;Server-Lschung fehlgeschlagen
(&quot;+(r.status||&quot;?&quot;)+&quot;)  lokaler Befund wird NICHT
gelscht.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
deleteReportLocal(localId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRenderReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartReportsPanel.open) chartReportsPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(remoteId ? &quot;Befund-Lschung: Server + lokal OK&quot; :
&quot;Befund-Lschung: lokal OK&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}finally{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>btn.disabled =
false; btn.textContent = old;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Doctor view ===== */<o:p></o:p></p>

<p class=MsoNormal>async function renderDoctor(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tbody =
$(&quot;#doctorTable tbody&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tbody.innerHTML =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const from =
$(&quot;#from&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const to =
$(&quot;#to&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const entries =
await getAllEntries();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>entries<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.filter(e=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (from
&amp;&amp; e.date &lt; from) return false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (to
&amp;&amp; e.date &gt; to) return false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>})<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.sort((a,b)=&gt; (
(a.ts ?? Date.parse(a.dateTime)) - (b.ts ?? Date.parse(b.dateTime)) ))<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.forEach(e=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
isTrainingOnly = e.training &amp;&amp; (!e.sys &amp;&amp; !e.dia &amp;&amp;
!e.pulse &amp;&amp; !e.weight);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const art =
isTrainingOnly ? &quot;Training&quot; : &quot;Messung&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const notesText
= isTrainingOnly ? (&quot;<span style='font-family:"Segoe UI Symbol",sans-serif;
mso-bidi-font-family:"Segoe UI Symbol"'>&#127947;</span> Training&quot; +
(e.notes ? &quot;  &quot; + e.notes : &quot;&quot;)) :
(e.notes||&quot;&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tr =
document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tr.innerHTML = `<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${e.date}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${e.time}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${art}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${isTrainingOnly ? &quot;&quot; :
(e.sys??&quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${isTrainingOnly ? &quot;&quot; :
(e.dia??&quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${isTrainingOnly ? &quot;&quot; :
(e.pulse??&quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${isTrainingOnly ? &quot;&quot; : fmtNum(e.map)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${isTrainingOnly ? &quot;&quot; : fmtNum(e.weight)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;notes&quot;&gt;${nl2br(notesText)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${e.low_intake ? &quot;Ja&quot; : &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${e.sick ? &quot;Ja&quot; : &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${e.valsartan_missed ? &quot;Ja&quot; :
&quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${e.forxiga_missed ? &quot;Ja&quot; : &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td&gt;${e.nsar_taken ? &quot;Ja&quot; : &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if
(!tbody.children.length) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tr =
document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tr.innerHTML =
`&lt;td colspan=&quot;14&quot; class=&quot;small&quot;
style=&quot;text-align:center;opacity:.7&quot;&gt;Keine Eintrge im
Zeitraum&lt;/td&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function renderDoctorReports(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tbody =
$(&quot;#doctorReportsTable tbody&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tbody.innerHTML =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const from =
$(&quot;#from&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const to =
$(&quot;#to&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const reports =
await getAllReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>reports<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.filter(r=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (!r.datum)
return false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (from
&amp;&amp; r.datum &lt; from) return false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (to
&amp;&amp; r.datum &gt; to) return false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>})<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.sort((a,b)=&gt;
(a.ts ?? new Date(a.datum).getTime()) - (b.ts ?? new Date(b.datum).getTime()))<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.forEach(r=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tr =
document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal>tr.innerHTML = `<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;nowrap&quot;&gt;${r.datum || &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.kreatinin<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.kreatinin).toFixed(2) : &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.egfr<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.egfr).toFixed(0)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.uacr<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.uacr).toFixed(0)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.kalium<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.kalium).toFixed(1)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.cystatin_c != null ?
Number(r.cystatin_c).toFixed(2): &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.haematurie != null ?
Number(r.haematurie).toFixed(0): &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.ldl<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.ldl).toFixed(0)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;center&quot;&gt;${r.hba1c<span style='mso-spacerun:yes'>
</span>!= null ? Number(r.hba1c).toFixed(1)<span style='mso-spacerun:yes'>
</span>: &quot;&quot;}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
class=&quot;notes&quot;&gt;${nl2br(r.kommentar || &quot;&quot;)}&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal>`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if
(!tbody.children.length) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const tr =
document.createElement(&quot;tr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>tr.innerHTML =
`&lt;td colspan=&quot;10&quot; class=&quot;small&quot;
style=&quot;text-align:center;opacity:.7&quot;&gt;Keine Befunde im
Zeitraum&lt;/td&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>tbody.appendChild(tr);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Simple SVG Chart (Daily) ===== */<o:p></o:p></p>

<p class=MsoNormal>const chartPanel = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>el:null, svg:null,
legend:null, open:false,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>init(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>this.el =
$(&quot;#chart&quot;); this.svg = $(&quot;#chartSvg&quot;); this.legend =
$(&quot;#chartLegend&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#chartClose&quot;).addEventListener(&quot;click&quot;,
()=&gt;this.hide());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#chartBtn&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{ this.toggle(); await this.draw(); });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#refreshChart&quot;).addEventListener(&quot;click&quot;, ()=&gt;
this.draw());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#savePng&quot;).addEventListener(&quot;click&quot;, ()=&gt;
this.savePNG());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#metricSel&quot;).addEventListener(&quot;change&quot;, ()=&gt;
this.draw());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#smoothChk&quot;).addEventListener(&quot;change&quot;, ()=&gt;
this.draw());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>toggle(){
this.open=!this.open; this.el.style.display=this.open?'block':'none'; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hide(){
this.open=false; this.el.style.display='none'; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>async getFiltered(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const entries =
await getAllEntries();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const from =
$(&quot;#from&quot;).value; const to = $(&quot;#to&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return
entries.filter(e=&gt;{ if (from &amp;&amp; e.date &lt; from) return false; if
(to &amp;&amp; e.date &gt; to) return false; return true; })<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.sort((a,b)=&gt; ((a.ts ?? Date.parse(a.dateTime)) - (b.ts ??
Date.parse(b.dateTime))));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ma(arr, k=3){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!$(&quot;#smoothChk&quot;).checked || k&lt;=1) return arr;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const out=[];
for(let i=0;i&lt;arr.length;i++){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const s =
Math.max(0,i-Math.floor(k/2));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const e =
Math.min(arr.length-1,i+Math.floor(k/2));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let sum=0, c=0;
for(let j=s;j&lt;=e;j++){ if(arr[j]!=null){ sum+=arr[j]; c++; } }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>out.push(c?sum/c:null);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} return out;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>async draw(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const metric =
$(&quot;#metricSel&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const data = await
this.getFiltered();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xs =
data.map(e =&gt; (e.ts ?? Date.parse(e.dateTime)));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let series = [];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(metric===&quot;bp&quot;){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y1 =
data.map(e =&gt; (e.sys!=null? Number(e.sys) : null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y2 =
data.map(e =&gt; (e.dia!=null? Number(e.dia) : null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>series = [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>{name:&quot;Systolisch&quot;, values:this.ma(y1),
color:&quot;#60a5fa&quot;},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>{name:&quot;Diastolisch&quot;, values:this.ma(y2),
color:&quot;#f472b6&quot;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}else
if(metric===&quot;pulse&quot;){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y =
data.map(e =&gt; (e.pulse!=null? Number(e.pulse) : null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>series =
[{name:&quot;Puls&quot;, values:this.ma(y), color:&quot;#34d399&quot;}];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}else
if(metric===&quot;weight&quot;){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y =
data.map(e =&gt; (e.weight!=null? Number(e.weight) : null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>series =
[{name:&quot;Gewicht (kg)&quot;, values:this.ma(y),
color:&quot;#f59e0b&quot;}];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const hasAny =
series.some(s =&gt; s.values.some(v=&gt;v!=null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.innerHTML=&quot;&quot;; this.legend.innerHTML=&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!hasAny){
this.svg.innerHTML = `&lt;text x=&quot;50%&quot; y=&quot;50%&quot;
text-anchor=&quot;middle&quot; fill=&quot;#9aa3af&quot;
font-size=&quot;14&quot;&gt;Keine darstellbaren Werte&lt;/text&gt;`; return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const W=640,H=280,
PL=48, PR=16, PT=12, PB=28;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
innerW=W-PL-PR, innerH=H-PT-PB;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xVals =
xs.filter(Boolean);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xmin =
Math.min(...xVals), xmax = Math.max(...xVals);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const allY =
series.flatMap(s =&gt; s.values.filter(v=&gt;v!=null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ymin =
Math.min(...allY);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ymax =
Math.max(...allY);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ypad =
Math.max( (ymax-ymin)*0.08, 1 );<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y0 = ymin -
ypad, y1max = ymax + ypad;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const x = t =&gt;
PL + ( (t - xmin) / Math.max(1,(xmax - xmin)) ) * innerW;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y = v =&gt;
PT + (1 - ( (v - y0) / Math.max(1,(y1max - y0)) )) * innerH;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
line(x1,y1,x2,y2, stroke, dash=&quot;&quot;){ return `&lt;line
x1=&quot;${x1}&quot; y1=&quot;${y1}&quot; x2=&quot;${x2}&quot;
y2=&quot;${y2}&quot; stroke=&quot;${stroke}&quot; stroke-width=&quot;1&quot; ${dash?`stroke-dasharray=&quot;${dash}&quot;`:&quot;&quot;}
/&gt;`; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
text(tx,ty,str,anchor=&quot;end&quot;){ return `&lt;text x=&quot;${tx}&quot;
y=&quot;${ty}&quot; fill=&quot;#9aa3af&quot; font-size=&quot;11&quot;
text-anchor=&quot;${anchor}&quot;&gt;${esc(str)}&lt;/text&gt;`; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let grid =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ticks = 4;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(let
i=0;i&lt;=ticks;i++){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const vv = y0 +
(i*(y1max-y0)/ticks);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const yy =
y(vv);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(PL,yy,W-PR,yy,&quot;#22262f&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
text(PL-6,yy+4, Math.round(vv).toString());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const week =
7*24*3600*1000;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let start = xmin -
(xmin % week) + week;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(let t=start;
t&lt;xmax; t+=week){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xx = x(t);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(xx,PT,xx,H-PB,&quot;#1b1f28&quot;,&quot;3 3&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const d = new
Date(t);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const lbl =
`${pad2(d.getDate())}.${pad2(d.getMonth()+1)}.`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid += text(xx,
H-8, lbl, &quot;middle&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(PL,PT,PL,H-PB,&quot;#2b2f3a&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(PL,H-PB,W-PR,H-PB,&quot;#2b2f3a&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.insertAdjacentHTML(&quot;beforeend&quot;, grid);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
pathFor(values, color){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let d =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>values.forEach((v,i)=&gt;{ if(v==null || !xs[i]) return; const cmd =
(d===&quot;&quot; ? &quot;M&quot; : &quot;L&quot;); d +=
`${cmd}${x(xs[i]).toFixed(1)},${y(v).toFixed(1)} `; });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return `&lt;path
d=&quot;${d}&quot; fill=&quot;none&quot; stroke=&quot;${color}&quot;
stroke-width=&quot;2.2&quot; /&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
dots(values, color){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let
out=&quot;&quot;; values.forEach((v,i)=&gt;{ if(v==null || !xs[i]) return; out
+= `&lt;circle cx=&quot;${x(xs[i]).toFixed(1)}&quot;
cy=&quot;${y(v).toFixed(1)}&quot; r=&quot;2.2&quot; fill=&quot;${color}&quot;
/&gt;`; });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return out;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>series.forEach(s=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.insertAdjacentHTML(&quot;beforeend&quot;, pathFor(s.values,
s.color));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.insertAdjacentHTML(&quot;beforeend&quot;, dots(s.values,
s.color));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const dot =
document.createElement(&quot;span&quot;); dot.className=&quot;dot&quot;;
dot.style.background=s.color;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const label =
document.createElement(&quot;span&quot;); label.textContent = s.name;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const wrap =
document.createElement(&quot;span&quot;);
wrap.style.display=&quot;inline-flex&quot;;
wrap.style.alignItems=&quot;center&quot;; wrap.style.gap=&quot;6px&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>wrap.appendChild(dot); wrap.appendChild(label);
this.legend.appendChild(wrap);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>async savePNG(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const svgEl =
this.svg;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xml = new
XMLSerializer().serializeToString(svgEl);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const svgBlob =
new Blob([xml], {type:&quot;image/svg+xml;charset=utf-8&quot;});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url =
URL.createObjectURL(svgBlob);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const img = new
Image();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>img.onload =
()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const canvas =
document.createElement(&quot;canvas&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>canvas.width =
svgEl.viewBox.baseVal.width || 640;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>canvas.height =
svgEl.viewBox.baseVal.height || 280;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ctx =
canvas.getContext(&quot;2d&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ctx.fillStyle =
&quot;#0f1116&quot;; ctx.fillRect(0,0,canvas.width,canvas.height);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>ctx.drawImage(img,0,0);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>canvas.toBlob(blob=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const a =
document.createElement(&quot;a&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.href =
URL.createObjectURL(blob);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.download =
`diagramm_daily_${new Date().toISOString().slice(0,10)}.png`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.click();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(a.href);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>},&quot;image/png&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(url);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>img.src = url;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Simple SVG Chart (Befunde) ===== */<o:p></o:p></p>

<p class=MsoNormal>const chartReportsPanel = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>el:null, svg:null,
legend:null, open:false,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>init(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>this.el =
$(&quot;#chartReports&quot;); this.svg = $(&quot;#chartReportsSvg&quot;);
this.legend = $(&quot;#chartReportsLegend&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#chartReportsClose&quot;).addEventListener(&quot;click&quot;,
()=&gt;this.hide());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#refreshReportChart&quot;).addEventListener(&quot;click&quot;,
()=&gt; this.draw());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#saveReportPng&quot;).addEventListener(&quot;click&quot;,
()=&gt; this.savePNG());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#reportMetricSel&quot;).addEventListener(&quot;change&quot;,
()=&gt; this.draw());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#reportSmoothChk&quot;).addEventListener(&quot;change&quot;,
()=&gt; this.draw());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>toggle(){
this.open=!this.open; this.el.style.display=this.open?'block':'none'; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hide(){
this.open=false; this.el.style.display='none'; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>async getFiltered(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const reps = await
getAllReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const from =
$(&quot;#from&quot;).value; const to = $(&quot;#to&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return
reps.filter(r=&gt;{ if(!r.datum) return false; if (from &amp;&amp; r.datum &lt;
from) return false; if (to &amp;&amp; r.datum &gt; to) return false; return
true; })<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.sort((a,b)=&gt; (a.ts ?? new Date(a.datum).getTime()) - (b.ts ?? new
Date(b.datum).getTime()));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ma(arr, k=3){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!$(&quot;#reportSmoothChk&quot;).checked || k&lt;=1) return arr;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const out=[];
for(let i=0;i&lt;arr.length;i++){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const s =
Math.max(0,i-Math.floor(k/2));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const e =
Math.min(arr.length-1,i+Math.floor(k/2));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let sum=0, c=0;
for(let j=s;j&lt;=e;j++){ if(arr[j]!=null){ sum+=arr[j]; c++; } }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>out.push(c?sum/c:null);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} return out;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>async draw(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const metric =
$(&quot;#reportMetricSel&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const data = await
this.getFiltered();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!data.length){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.innerHTML = `&lt;text x=&quot;50%&quot; y=&quot;50%&quot;
text-anchor=&quot;middle&quot; fill=&quot;#9aa3af&quot;
font-size=&quot;14&quot;&gt;Keine Befunde im Zeitraum&lt;/text&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.legend.innerHTML = &quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xs =
data.map(r =&gt; (r.ts ?? new Date(r.datum).getTime()));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const vals =
data.map(r =&gt; (r[metric] != null ? Number(r[metric]) : null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const series =
[{name: metricLabel(metric), values: this.ma(vals), color:
&quot;#60a5fa&quot;}];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const hasAny =
series.some(s =&gt; s.values.some(v=&gt;v!=null));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.innerHTML=&quot;&quot;; this.legend.innerHTML=&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!hasAny){
this.svg.innerHTML = `&lt;text x=&quot;50%&quot; y=&quot;50%&quot;
text-anchor=&quot;middle&quot; fill=&quot;#9aa3af&quot;
font-size=&quot;14&quot;&gt;Keine darstellbaren Werte&lt;/text&gt;`; return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const W=640,H=280,
PL=48, PR=16, PT=12, PB=28;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
innerW=W-PL-PR, innerH=H-PT-PB;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xVals =
xs.filter(Boolean);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xmin =
Math.min(...xVals), xmax = Math.max(...xVals);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const yVals =
series[0].values.filter(v=&gt;v!=null);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ymin =
Math.min(...yVals), ymax = Math.max(...yVals);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ypad =
Math.max((ymax-ymin)*0.08, 1);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y0 = ymin -
ypad, y1max = ymax + ypad;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const x = t =&gt;
PL + ( (t - xmin) / Math.max(1,(xmax - xmin)) ) * innerW;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const y = v =&gt;
PT + (1 - ( (v - y0) / Math.max(1,(y1max - y0)) )) * innerH;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
line(x1,y1,x2,y2, stroke, dash=&quot;&quot;){ return `&lt;line
x1=&quot;${x1}&quot; y1=&quot;${y1}&quot; x2=&quot;${x2}&quot;
y2=&quot;${y2}&quot; stroke=&quot;${stroke}&quot; stroke-width=&quot;1&quot; ${dash?`stroke-dasharray=&quot;${dash}&quot;`:&quot;&quot;}
/&gt;`; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
text(tx,ty,str,anchor=&quot;end&quot;){ return `&lt;text x=&quot;${tx}&quot;
y=&quot;${ty}&quot; fill=&quot;#9aa3af&quot; font-size=&quot;11&quot;
text-anchor=&quot;${anchor}&quot;&gt;${esc(str)}&lt;/text&gt;`; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let grid =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ticks = 4;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(let
i=0;i&lt;=ticks;i++){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const vv = y0 +
(i*(y1max-y0)/ticks);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const yy =
y(vv);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(PL,yy,W-PR,yy,&quot;#22262f&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
text(PL-6,yy+4, roundSmart(vv).toString());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const month =
30*24*3600*1000;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let start = xmin -
(xmin % month) + month;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(let t=start;
t&lt;xmax; t+=month){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xx = x(t);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(xx,PT,xx,H-PB,&quot;#1b1f28&quot;,&quot;3 3&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const d = new
Date(t);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const lbl =
`${pad2(d.getDate())}.${pad2(d.getMonth()+1)}.`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid += text(xx,
H-8, lbl, &quot;middle&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(PL,PT,PL,H-PB,&quot;#2b2f3a&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>grid +=
line(PL,H-PB,W-PR,H-PB,&quot;#2b2f3a&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.insertAdjacentHTML(&quot;beforeend&quot;, grid);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
pathFor(values, color){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let d =
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>values.forEach((v,i)=&gt;{ if(v==null || !xs[i]) return; const cmd =
(d===&quot;&quot; ? &quot;M&quot; : &quot;L&quot;); d +=
`${cmd}${x(xs[i]).toFixed(1)},${y(v).toFixed(1)} `; });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return `&lt;path
d=&quot;${d}&quot; fill=&quot;none&quot; stroke=&quot;${color}&quot;
stroke-width=&quot;2.2&quot; /&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
dots(values, color){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let
out=&quot;&quot;; values.forEach((v,i)=&gt;{ if(v==null || !xs[i]) return; out
+= `&lt;circle cx=&quot;${x(xs[i]).toFixed(1)}&quot;
cy=&quot;${y(v).toFixed(1)}&quot; r=&quot;2.2&quot; fill=&quot;${color}&quot;
/&gt;`; });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return out;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>series.forEach(s=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.insertAdjacentHTML(&quot;beforeend&quot;, pathFor(s.values,
s.color));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>this.svg.insertAdjacentHTML(&quot;beforeend&quot;, dots(s.values,
s.color));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const dot =
document.createElement(&quot;span&quot;); dot.className=&quot;dot&quot;;
dot.style.background=s.color;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const label =
document.createElement(&quot;span&quot;); label.textContent = s.name;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const wrap =
document.createElement(&quot;span&quot;);
wrap.style.display=&quot;inline-flex&quot;;
wrap.style.alignItems=&quot;center&quot;; wrap.style.gap=&quot;6px&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>wrap.appendChild(dot); wrap.appendChild(label);
this.legend.appendChild(wrap);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>function
roundSmart(v){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const abs =
Math.abs(v);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(abs &gt;=
100) return Math.round(v);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(abs &gt;= 10)
return Math.round(v*10)/10;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return
Math.round(v*100)/100;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>function metricLabel(m){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>switch(m){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;kreatinin&quot;:<span style='mso-spacerun:yes'> </span>return
&quot;Kreatinin (mg/dL)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;egfr&quot;:<span style='mso-spacerun:yes'> </span>return &quot;eGFR
(ml/min/1.73m)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;uacr&quot;:<span style='mso-spacerun:yes'> </span>return &quot;uACR
(mg/g)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;kalium&quot;:<span style='mso-spacerun:yes'> </span>return
&quot;Kalium (mmol/L)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;cystatin_c&quot;: return &quot;Cystatin C (mg/L)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;haematurie&quot;: return &quot;Hmaturie (Ery/L)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;ldl&quot;:<span style='mso-spacerun:yes'> </span>return &quot;LDL
(mg/dL)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
&quot;hba1c&quot;:<span style='mso-spacerun:yes'> </span>return
&quot;HbA1c (%)&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>default:<span
style='mso-spacerun:yes'> </span>return m;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>async savePNG(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const svgEl =
this.svg;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const xml = new
XMLSerializer().serializeToString(svgEl);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const svgBlob =
new Blob([xml], {type:&quot;image/svg+xml;charset=utf-8&quot;});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url =
URL.createObjectURL(svgBlob);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const img = new
Image();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>img.onload =
()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const canvas =
document.createElement(&quot;canvas&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>canvas.width =
svgEl.viewBox.baseVal.width || 640;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>canvas.height =
svgEl.viewBox.baseVal.height || 280;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ctx =
canvas.getContext(&quot;2d&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ctx.fillStyle =
&quot;#0f1116&quot;; ctx.fillRect(0,0,canvas.width,canvas.height);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>ctx.drawImage(img,0,0);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>canvas.toBlob(blob=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const a =
document.createElement(&quot;a&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.href =
URL.createObjectURL(blob);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.download =
`diagramm_befunde_${new Date().toISOString().slice(0,10)}.png`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>a.click();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(a.href);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>},&quot;image/png&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(url);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>img.src = url;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* --- Button-Flash --- */<o:p></o:p></p>

<p class=MsoNormal>let saveFlashTimer = null;<o:p></o:p></p>

<p class=MsoNormal>function flashSaveOk(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const btn =
document.getElementById('saveAllBtn');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!btn) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (saveFlashTimer)
{ clearTimeout(saveFlashTimer); saveFlashTimer = null; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>btn.disabled = true;
btn.classList.add('flash'); btn.innerHTML = '<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#9989;</span> Gespeichert';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>saveFlashTimer =
setTimeout(()=&gt;{ btn.classList.remove('flash'); btn.innerHTML = '<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#128190;</span>
Speichern'; btn.disabled = false; saveFlashTimer = null; }, 1000);<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Tabs / Segments ===== */<o:p></o:p></p>

<p class=MsoNormal>function setTab(name){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$$(&quot;.view&quot;).forEach(v=&gt;v.classList.remove(&quot;active&quot;));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#&quot;+name).classList.add(&quot;active&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>$$(&quot;.tabs
.btn&quot;).forEach(b=&gt; b.classList.toggle(&quot;primary&quot;,
b.dataset.tab===name));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(name===&quot;doctor&quot;){ renderDoctorViewForMode(); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(name===&quot;list&quot;){ loadAndRender(); }<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function bindTabs(){ $$(&quot;.tabs
.btn&quot;).forEach(b=&gt; b.addEventListener(&quot;click&quot;, e=&gt;
setTab(e.currentTarget.dataset.tab))); }<o:p></o:p></p>

<p class=MsoNormal>function bindCaptureSegment(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const seg =
$(&quot;#seg-capture&quot;); if(!seg) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>seg.querySelectorAll(&quot;.seg-btn&quot;).forEach(b=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>b.addEventListener(&quot;click&quot;, ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mode =
b.dataset.mode;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>seg.querySelectorAll(&quot;.seg-btn&quot;).forEach(x=&gt;x.classList.toggle(&quot;active&quot;,
x===b));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#entry&quot;).classList.toggle(&quot;hidden&quot;, mode !==
&quot;daily&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#entry_befund&quot;).classList.toggle(&quot;hidden&quot;, mode
!== &quot;befund&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function bindListSegment(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const seg =
$(&quot;#seg-list&quot;); if(!seg) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>seg.querySelectorAll(&quot;.seg-btn&quot;).forEach(b=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>b.addEventListener(&quot;click&quot;, async ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mode =
b.dataset.mode;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>seg.querySelectorAll(&quot;.seg-btn&quot;).forEach(x=&gt;x.classList.toggle(&quot;active&quot;,
x===b));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#listDailyWrap&quot;).classList.toggle(&quot;hidden&quot;,
mode!==&quot;daily&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#listReportWrap&quot;).classList.toggle(&quot;hidden&quot;,
mode!==&quot;befund&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(mode===&quot;befund&quot;){ await loadAndRenderReports(); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else { await
loadAndRender(); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function bindDoctorSegment(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const seg =
$(&quot;#seg-doctor&quot;); if(!seg) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>seg.querySelectorAll(&quot;.seg-btn&quot;).forEach(b=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>b.addEventListener(&quot;click&quot;, async ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mode =
b.dataset.mode;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>seg.querySelectorAll(&quot;.seg-btn&quot;).forEach(x=&gt;x.classList.toggle(&quot;active&quot;,
x===b));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#doctorDailyWrap&quot;).classList.toggle(&quot;hidden&quot;,
mode!==&quot;daily&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#doctorReportWrap&quot;).classList.toggle(&quot;hidden&quot;,
mode!==&quot;befund&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#doctorTitle&quot;).textContent = `Arzt-Ansicht 
${mode===&quot;daily&quot;?&quot;Daily&quot;:&quot;Befunde&quot;}`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(mode===&quot;daily&quot;) await renderDoctor();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else await
renderDoctorReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function activeDoctorMode(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const btn =
$(&quot;#seg-doctor .seg-btn.active&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return btn ?
btn.dataset.mode : &quot;daily&quot;;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function renderDoctorViewForMode(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mode =
activeDoctorMode();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(mode===&quot;daily&quot;) await renderDoctor();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else await
renderDoctorReports();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Save flows ===== */<o:p></o:p></p>

<p class=MsoNormal>let trainingActive=false, lowIntakeActive=false,
sickActive=false, valsartanMissed=false, forxigaMissed=false, nsarTaken=false;<o:p></o:p></p>

<p class=MsoNormal>function setToggle(el, on, activeText, baseText){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>el.classList.toggle(&quot;active&quot;, !!on);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>el.setAttribute(&quot;aria-pressed&quot;, on ? &quot;true&quot; :
&quot;false&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>el.textContent = on
? activeText : baseText;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function setTraining(on){ trainingActive=!!on;
setToggle($(&quot;#trainingToggle&quot;), trainingActive, &quot;<span
style='font-family:"Segoe UI Symbol",sans-serif;mso-bidi-font-family:"Segoe UI Symbol"'>&#127947;</span>
Training heute (aktiv)&quot;, &quot;<span style='font-family:"Segoe UI Symbol",sans-serif;
mso-bidi-font-family:"Segoe UI Symbol"'>&#127947;</span> Training heute&quot;);
}<o:p></o:p></p>

<p class=MsoNormal>function setLowIntake(on){ lowIntakeActive=!!on;
setToggle($(&quot;#lowIntakeToggle&quot;), lowIntakeActive, &quot;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#129380;</span>
&lt; 2 L  aktiv&quot;, &quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#129380;</span> &lt; 2 L
getrunken&quot;); }<o:p></o:p></p>

<p class=MsoNormal>function setSick(on){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>sickActive=!!on;
setToggle($(&quot;#sickToggle&quot;), sickActive, &quot;<span style='font-family:
"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#129298;</span>
Krank (Forxiga pausiert)  aktiv&quot;, &quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#129298;</span> Krank (Forxiga
pausiert)&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(sickActive){
setForxigaMiss(true); $(&quot;#forxigaMissToggle&quot;).disabled=true;
$(&quot;#forxigaMissToggle&quot;).style.opacity=0.6; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else {
$(&quot;#forxigaMissToggle&quot;).disabled=false;
$(&quot;#forxigaMissToggle&quot;).style.opacity=1; }<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>function setValsartanMiss(on){ valsartanMissed=!!on;
setToggle($(&quot;#valsartanMissToggle&quot;), valsartanMissed, &quot;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#128138;</span>
Valsartan vergessen  aktiv&quot;, &quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#128138;</span> Valsartan
vergessen&quot;); }<o:p></o:p></p>

<p class=MsoNormal>function setForxigaMiss(on){ forxigaMissed=!!on;
setToggle($(&quot;#forxigaMissToggle&quot;), forxigaMissed, &quot;<span
style='font-family:"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#128138;</span>
Forxiga vergessen  aktiv&quot;, &quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#128138;</span> Forxiga
vergessen&quot;); }<o:p></o:p></p>

<p class=MsoNormal>function setNsar(on){ nsarTaken=!!on;
setToggle($(&quot;#nsarToggle&quot;), nsarTaken, &quot;<span style='font-family:
"Segoe UI Emoji",sans-serif;mso-bidi-font-family:"Segoe UI Emoji"'>&#129514;</span>
NSAR genommen  aktiv&quot;, &quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#129514;</span> NSAR genommen&quot;); }<o:p></o:p></p>

<p class=MsoNormal>function blockHasData(which){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return !!(<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(`#time${which}`).value ||<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(`#sys${which}`).value ||<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(`#dia${which}`).value ||<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(`#pulse${which}`).value ||<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#weightDay&quot;)?.value<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function saveAll(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!(await
isLoggedIn())){ alert(&quot;Bitte zuerst mit Google anmelden.&quot;); return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const hasM =
blockHasData(&quot;M&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const hasA =
blockHasData(&quot;A&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const weightVal =
$(&quot;#weightDay&quot;)?.value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mVitals =
$(&quot;#timeM&quot;).value || $(&quot;#sysM&quot;).value ||
$(&quot;#diaM&quot;).value || $(&quot;#pulseM&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const aVitals =
$(&quot;#timeA&quot;).value || $(&quot;#sysA&quot;).value ||
$(&quot;#diaA&quot;).value || $(&quot;#pulseA&quot;).value;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const weightOnly =
!!(weightVal &amp;&amp; !mVitals &amp;&amp; !aVitals);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let savedM = false,
savedA = false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(weightOnly){
savedM = await saveBlock(&quot;Morgen&quot;,&quot;M&quot;); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(hasM) savedM =
await saveBlock(&quot;Morgen&quot;,&quot;M&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(hasA) savedA =
await saveBlock(&quot;Abend&quot;,&quot;A&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!savedM
&amp;&amp; !savedA){ alert(&quot;Keine Daten eingegeben  nichts zu
speichern.&quot;); return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>loadAndRender();
renderDoctorViewForMode(); if(chartPanel.open) chartPanel.draw();
if(chartReportsPanel.open) chartReportsPanel.draw(); flashSaveOk();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function saveBlock(contextLabel, which){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!blockHasData(which)) return false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const date =
$(&quot;#date&quot;).value || todayStr();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const time =
$(`#time${which}`).value || timeStr();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const sys =
$(`#sys${which}`).value ? Number($(`#sys${which}`).value) : null;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const dia =
$(`#dia${which}`).value ? Number($(`#dia${which}`).value) : null;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const pulse =
$(`#pulse${which}`).value ? Number($(`#pulse${which}`).value) : null;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const weight =
$(&quot;#weightDay&quot;)?.value ? Number($(&quot;#weightDay&quot;).value) :
null;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const dayNotes =
$(&quot;#notesDay&quot;).value ? $(&quot;#notesDay&quot;).value.trim() :
&quot;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const currentISO =
new Date(date+&quot;T&quot;+time).toISOString();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const ts = new
Date(date+&quot;T&quot;+time).getTime();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const entry = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>date, time,
dateTime: currentISO, ts, context: contextLabel, arm: &quot;links&quot;,
position: &quot;sitzend&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>sys, dia, pulse,
weight, map: (sys!=null &amp;&amp; dia!=null) ? calcMAP(sys, dia) : null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>notes: dayNotes,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>training:
trainingActive, low_intake: lowIntakeActive, sick: sickActive,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>valsartan_missed:
valsartanMissed, forxiga_missed: forxigaMissed, nsar_taken: nsarTaken<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const localId =
await addEntry(entry);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
syncWebhook(entry, localId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return true;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function saveReport(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!(await
isLoggedIn())){ alert(&quot;Bitte zuerst mit Google anmelden.&quot;); return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const datum =
$(&quot;#repDate&quot;).value || todayStr();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const report = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>datum,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kreatinin:
$(&quot;#repKrea&quot;).value ? Number($(&quot;#repKrea&quot;).value) : null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>egfr:<span
style='mso-spacerun:yes'> </span>$(&quot;#repEgfr&quot;).value ?
Number($(&quot;#repEgfr&quot;).value) : null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>uacr:<span
style='mso-spacerun:yes'> </span>$(&quot;#repUacr&quot;).value ?
Number($(&quot;#repUacr&quot;).value) : null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kalium:<span
style='mso-spacerun:yes'> </span>$(&quot;#repK&quot;).value<span
style='mso-spacerun:yes'> </span>? Number($(&quot;#repK&quot;).value)<span
style='mso-spacerun:yes'> </span>: null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>cystatin_c:
$(&quot;#repCys&quot;).value<span style='mso-spacerun:yes'> </span>?
Number($(&quot;#repCys&quot;).value)<span style='mso-spacerun:yes'> </span>:
null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>haematurie:
$(&quot;#repHaem&quot;).value<span style='mso-spacerun:yes'> </span>?
Number($(&quot;#repHaem&quot;).value)<span style='mso-spacerun:yes'> </span>:
null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ldl:<span
style='mso-spacerun:yes'> </span>$(&quot;#repLDL&quot;).value<span
style='mso-spacerun:yes'> </span>? Number($(&quot;#repLDL&quot;).value)<span
style='mso-spacerun:yes'> </span>: null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hba1c:<span
style='mso-spacerun:yes'> </span>$(&quot;#repHbA1c&quot;).value<span
style='mso-spacerun:yes'> </span>? Number($(&quot;#repHbA1c&quot;).value)<span
style='mso-spacerun:yes'> </span>: null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kommentar:
$(&quot;#repNote&quot;).value?.trim() || &quot;&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>source:
&quot;manuell&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ts: new
Date(datum+&quot;T00:00:00&quot;).getTime()<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const localId =
await addReport(report);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
syncReportWebhook(report, localId);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const btn =
$(&quot;#saveReportBtn&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const old =
btn.innerHTML; btn.disabled=true; btn.classList.add(&quot;flash&quot;);
btn.innerHTML=&quot;<span style='font-family:"Segoe UI Emoji",sans-serif;
mso-bidi-font-family:"Segoe UI Emoji"'>&#9989;</span> Befund gespeichert&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setTimeout(()=&gt;{
btn.classList.remove(&quot;flash&quot;); btn.innerHTML=old; btn.disabled=false;
},800);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>[&quot;#repKrea&quot;,&quot;#repEgfr&quot;,&quot;#repUacr&quot;,&quot;#repK&quot;,&quot;#repCys&quot;,&quot;#repHaem&quot;,&quot;#repLDL&quot;,&quot;#repHbA1c&quot;,&quot;#repNote&quot;]<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>.forEach(sel=&gt;{
const el=$(sel); if(el) el.value=&quot;&quot;; });<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function syncWebhook(entry, localId){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrl&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!url || !headers)
return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const { id: _d1,
remote_id: _d2, ...safe } = entry;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const res = await
fetch(url, { method:&quot;POST&quot;, headers, body: JSON.stringify(safe) });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!res.ok){
diag.add(`Webhook-Fehler ${res.status}`); return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const json = await
res.json();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const remoteId =
json?.[0]?.id;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(remoteId!=null){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
updateEntry(localId, { remote_id: remoteId });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(&quot;Webhook: OK&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch(e){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(&quot;Webhook: Netzwerkfehler&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Realtime / Auto-Sync ===== */<o:p></o:p></p>

<p class=MsoNormal>let sbClient = null;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>function baseUrlFromRest(restUrl){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!restUrl) return
null;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const i =
restUrl.indexOf(&quot;/rest/&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return i&gt;0 ?
restUrl.slice(0, i) : null;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>async function ensureSupabaseClient(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (sbClient) return
sbClient;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const rest = await
getConf(&quot;webhookUrl&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const keyConf =
await getConf(&quot;webhookKey&quot;); // ANON key (nicht service_role)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (!rest ||
!keyConf) { diag.add(&quot;Supabase Auth: fehlende Konfiguration&quot;); return
null; }<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const supabaseUrl =
baseUrlFromRest(rest);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const anonKey =
keyConf.replace(/^Bearer\s+/i,&quot;&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (!supabaseUrl ||
!anonKey) { diag.add(&quot;Supabase Auth: ungltige URL/Key&quot;); return
null; }<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>sbClient =
window.supabase.createClient(supabaseUrl, anonKey, {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>auth: {
persistSession:true, autoRefreshToken:true, detectSessionInUrl:true }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(&quot;Supabase: Client (Auth) initialisiert&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return sbClient;<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal>async function setupRealtime(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const supa = await
ensureSupabaseClient();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!supa) return;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// health_entries<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>supa.channel('ch_health_entries')<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.on('postgres_changes', { event: '*', schema: 'public', table:
'health_entries' }, async (payload)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const et =
payload.eventType; const n = payload.new; const o = payload.old;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(et ===
'INSERT' || et === 'UPDATE'){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const row = n;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mapped =
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>date:
row.date, time: row.time, dateTime: row.dateTime, ts: row.ts, context:
row.context,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>arm:
row.arm, position: row.position, sys: row.sys, dia: row.dia, pulse: row.pulse,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>weight:
row.weight, map: row.map, notes: row.notes,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>training:
row.training, low_intake: row.low_intake, sick: row.sick,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>valsartan_missed: row.valsartan_missed, forxiga_missed:
row.forxiga_missed, nsar_taken: row.nsar_taken,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>remote_id:
row.id<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const existing
= await getEntryByRemoteId(row.id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(existing){
await updateEntry(existing.id, mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else{ await
addEntry(mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRender();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(activeDoctorMode()===&quot;daily&quot;) await renderDoctor();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartPanel.open) chartPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(`Realtime health_entries: ${et}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(et ===
'DELETE'){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const rid =
o?.id;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(rid!=null){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
existing = await getEntryByRemoteId(rid);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(existing){ await deleteEntryLocal(existing.id); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRender();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(activeDoctorMode()===&quot;daily&quot;) await renderDoctor();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartPanel.open) chartPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(&quot;Realtime health_entries: DELETE&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>})<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.subscribe((status)=&gt;{ if(status==='SUBSCRIBED')
diag.add(&quot;Realtime health_entries: subscribed&quot;); });<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// medical_reports<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>supa.channel('ch_medical_reports')<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.on('postgres_changes', { event: '*', schema: 'public', table:
'medical_reports' }, async (payload)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const et =
payload.eventType; const n = payload.new; const o = payload.old;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(et ===
'INSERT' || et === 'UPDATE'){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const row = n;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mapped =
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>datum:
row.datum,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kreatinin:
row.kreatinin ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>egfr:
row.egfr ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>uacr:
row.uacr ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kalium:
row.kalium ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>cystatin_c:
row.cystatin_c ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hba1c:
row.hba1c ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ldl: row.ldl
?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hdl: row.hdl
?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>haematurie:
row.haematurie ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kommentar:
row.kommentar ?? &quot;&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>source:
row.source ?? &quot;manuell&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ts: row.ts
?? new Date((row.datum||'')+&quot;T00:00:00&quot;).getTime(),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>remote_id:
row.id<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const existing
= await getReportByRemoteId(row.id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(existing){
await updateReport(existing.id, mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else{ await
addReport(mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRenderReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(activeDoctorMode()===&quot;befund&quot;) await renderDoctorReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartReportsPanel.open) chartReportsPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(`Realtime medical_reports: ${et}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(et ===
'DELETE'){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const rid =
o?.id;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(rid!=null){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
existing = await getReportByRemoteId(rid);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(existing){ await deleteReportLocal(existing.id); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRenderReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(activeDoctorMode()===&quot;befund&quot;) await renderDoctorReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartReportsPanel.open) chartReportsPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(&quot;Realtime medical_reports: DELETE&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>})<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>.subscribe((status)=&gt;{ if(status==='SUBSCRIBED')
diag.add(&quot;Realtime medical_reports: subscribed&quot;); });<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function reconcileFromRemote(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Daily<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const remoteRows =
await pullAllFromRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const seen = new
Set(remoteRows.map(r=&gt;r.id));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(const r of
remoteRows){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mapped = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>date: r.date,
time: r.time, dateTime: r.dateTime, ts: r.ts, context: r.context,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>arm: r.arm,
position: r.position, sys: r.sys, dia: r.dia, pulse: r.pulse,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>weight:
r.weight, map: r.map, notes: r.notes,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>training:
r.training, low_intake: r.low_intake, sick: r.sick,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>valsartan_missed: r.valsartan_missed, forxiga_missed: r.forxiga_missed,
nsar_taken: r.nsar_taken,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>remote_id: r.id<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const existing =
await getEntryByRemoteId(r.id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(existing){
await updateEntry(existing.id, mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else { await
addEntry(mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Entferne lokale
Eintrge, die serverseitig gelscht wurden<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const allLocal =
await getAllEntries();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(const e of
allLocal){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(e.remote_id
&amp;&amp; !seen.has(e.remote_id)){ await deleteEntryLocal(e.id); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRender();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
renderDoctorViewForMode();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(chartPanel.open)
chartPanel.draw();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function reconcileReportsFromRemote(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const remoteRows =
await pullAllReportsFromRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const seen = new
Set(remoteRows.map(r=&gt;r.id));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(const r of
remoteRows){<o:p></o:p></p>

<p class=MsoNormal>const mapped = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>datum: r.datum,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kreatinin:
r.kreatinin ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>egfr: r.egfr ??
null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>uacr: r.uacr ??
null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kalium: r.kalium ??
null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hba1c: r.hba1c ??
null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ldl: r.ldl ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>hdl: r.hdl ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>haematurie:
r.haematurie ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>cystatin_c:
r.cystatin_c ?? null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>kommentar:
r.kommentar ?? &quot;&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>source: r.source ??
&quot;remote&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>ts: r.ts ?? new
Date((r.datum || '') + &quot;T00:00:00&quot;).getTime(),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>remote_id: r.id<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const existing =
await getReportByRemoteId(r.id);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(existing){
await updateReport(existing.id, mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else{ await
addReport(mapped); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const allLocal =
await getAllReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(const r of
allLocal){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(r.remote_id
&amp;&amp; !seen.has(r.remote_id)){ await deleteReportLocal(r.id); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRenderReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(activeDoctorMode()===&quot;befund&quot;) await renderDoctorReports();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartReportsPanel.open) chartReportsPanel.draw();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal>async function initialAutoSync(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const headers =
await getHeaders();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const url = await
getConf(&quot;webhookUrl&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(!headers ||
!url){ diag.add(&quot;Auto-Sync: keine Konfiguration  bersprungen&quot;);
return; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setBusy(true);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const push = await
pushPendingToRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(push.pushed ||
push.failed) diag.add(`Auto-Push: OK=${push.pushed}, FAIL=${push.failed}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
reconcileFromRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
reconcileReportsFromRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(&quot;Auto-Sync: Abgleich fertig (ohne Wipe)&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch(e){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(&quot;Auto-Sync: Fehler  &quot; + (e.message||e));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}finally{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setBusy(false);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* ===== Main ===== */<o:p></o:p></p>

<p class=MsoNormal>async function main(){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>diag.init();
helpPanel.init(); await initDB();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>chartPanel.init();
chartReportsPanel.init(); bindTabs();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#date&quot;).value = todayStr();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#timeM&quot;).value = &quot;07:00&quot;;
$(&quot;#timeA&quot;).value = &quot;19:00&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#from&quot;).value = new
Date(Date.now()-30*24*3600*1000).toISOString().slice(0,10);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#to&quot;).value = todayStr();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>setTab(&quot;capture&quot;);<o:p></o:p></p>

<p class=MsoNormal>await ensureSupabaseClient();<o:p></o:p></p>

<p class=MsoNormal>bindAuthButtons();<o:p></o:p></p>

<p class=MsoNormal>watchAuthState();<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// Wenn schon eingeloggt &#8594; App starten, sonst
Login-Leiste zeigen<o:p></o:p></p>

<p class=MsoNormal>const hasSession = await requireSession();<o:p></o:p></p>

<p class=MsoNormal>if (hasSession) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
afterLoginBoot();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Konfiguration
laden<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const savedUrl =
await getConf(&quot;webhookUrl&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const savedKey =
await getConf(&quot;webhookKey&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const savedMrUrl =
await getConf(&quot;webhookUrlMr&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (savedUrl)
$(&quot;#whUrl&quot;).value = savedUrl;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (savedKey)
$(&quot;#whKey&quot;).value = savedKey;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (savedMrUrl)
$(&quot;#whUrlMr&quot;).value = savedMrUrl;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Sanfte Warnung<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>[&quot;#sysM&quot;,&quot;#diaM&quot;,&quot;#pulseM&quot;,&quot;#sysA&quot;,&quot;#diaA&quot;,&quot;#pulseA&quot;,&quot;#weightDay&quot;].forEach(sel=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const el = $(sel);
if(!el) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>el.addEventListener(&quot;input&quot;, ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if
(sel.includes(&quot;sys&quot;))<span style='mso-spacerun:yes'>
</span>softWarnRange(el, 70, 220);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else if
(sel.includes(&quot;dia&quot;))<span style='mso-spacerun:yes'>
</span>softWarnRange(el, 40, 140);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else if
(sel.includes(&quot;pulse&quot;)) softWarnRange(el, 30, 180);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else if
(sel.includes(&quot;weight&quot;))softWarnRange(el, 30, 300);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Toggle-Handler<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const bindToggle =
(id, setter, getVal)=&gt;{ const el=$(id);
el.addEventListener(&quot;click&quot;, ()=&gt; setter(!getVal())); };<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>bindToggle(&quot;#trainingToggle&quot;, setTraining,
()=&gt;trainingActive);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>bindToggle(&quot;#lowIntakeToggle&quot;, setLowIntake,
()=&gt;lowIntakeActive);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>bindToggle(&quot;#sickToggle&quot;, setSick, ()=&gt;sickActive);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>bindToggle(&quot;#valsartanMissToggle&quot;, setValsartanMiss,
()=&gt;valsartanMissed);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>bindToggle(&quot;#forxigaMissToggle&quot;, setForxigaMiss,
()=&gt;forxigaMissed);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>bindToggle(&quot;#nsarToggle&quot;, setNsar, ()=&gt;nsarTaken);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#saveAllBtn&quot;).addEventListener(&quot;click&quot;, saveAll);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#applyRange&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{ await renderDoctorViewForMode(); if(chartPanel.open)
chartPanel.draw(); if(chartReportsPanel.open) chartReportsPanel.draw(); });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#printBtn&quot;).addEventListener(&quot;click&quot;, ()=&gt;
window.print());<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#doctorChartBtn&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const mode =
activeDoctorMode();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(mode===&quot;daily&quot;){ chartPanel.toggle(); if(chartPanel.open)
await chartPanel.draw(); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>else {
chartReportsPanel.toggle(); if(chartReportsPanel.open) await
chartReportsPanel.draw(); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>document.addEventListener('keydown', (e)=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const isSave =
(e.key.toLowerCase()==='s') &amp;&amp; (e.ctrlKey || e.metaKey);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(isSave){
e.preventDefault(); saveAll(); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#rangeSel&quot;).addEventListener(&quot;change&quot;,
loadAndRender);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#exportCsv&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{ const all = await getAllEntries(); dl(&quot;gesundheitslog.csv&quot;,
toCSV(all), &quot;text/csv&quot;); });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#exportJson&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{ const all = await getAllEntries(); dl(&quot;gesundheitslog.json&quot;,
JSON.stringify(all,null,2), &quot;application/json&quot;); });<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#wipeBtn&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{ if(confirm(&quot;Alle lokalen Daily-Eintrge lschen?&quot;)){ await
wipeAll(); loadAndRender(); renderDoctorViewForMode(); if(chartPanel.open)
chartPanel.draw(); if(chartReportsPanel.open) chartReportsPanel.draw(); } });<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#saveWebhook&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
putConf(&quot;webhookUrl&quot;, $(&quot;#whUrl&quot;).value.trim());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
putConf(&quot;webhookKey&quot;, $(&quot;#whKey&quot;).value.trim());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
putConf(&quot;webhookUrlMr&quot;, $(&quot;#whUrlMr&quot;).value.trim());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#whSaved&quot;).textContent = &quot;Gespeichert &#10003;&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>setTimeout(()=&gt;$(&quot;#whSaved&quot;).textContent=&quot;&quot;,
2000);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// MANUELLER SYNC
(Daily)  bleibt als Last Resort<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#syncBtn&quot;).addEventListener(&quot;click&quot;, async
()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(!confirm(&quot;SYNC (Daily) startet:\\n1) Backup CSV
herunterladen\\n2) Ausstehende lokale Eintrge an Supabase senden\\n3) Lokale
Liste leeren\\n4) Frische Daten von Supabase laden\\nFortfahren?&quot;)) return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setBusy(true);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#syncBtn&quot;).disabled = true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const current =
await getAllEntries();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>dl(&quot;backup_vor_sync.csv&quot;, toCSV(current),
&quot;text/csv&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const resPush =
await pushPendingToRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>diag.add(`SYNC:
Pending gepusht &#8594; OK=${resPush.pushed}, FAIL=${resPush.failed}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await wipeAll();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const remoteRows
= await pullAllFromRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for(const r of
remoteRows){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const entry =
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>date:
r.date, time: r.time, dateTime: r.dateTime, ts: r.ts, context: r.context,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>arm: r.arm,
position: r.position, sys: r.sys, dia: r.dia, pulse: r.pulse,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>weight:
r.weight, map: r.map, notes: r.notes,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>training:
r.training, low_intake: r.low_intake, sick: r.sick,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>valsartan_missed: r.valsartan_missed, forxiga_missed: r.forxiga_missed,
nsar_taken: r.nsar_taken,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>remote_id:
r.id<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
addEntry(entry);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRender(); await renderDoctorViewForMode();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartPanel.open) await chartPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>if(chartReportsPanel.open) await chartReportsPanel.draw();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>diag.add(`SYNC:
${remoteRows.length} Eintrge vom Server geladen`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>alert(&quot;Sync
abgeschlossen.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}catch(e){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>console.error(e); alert(&quot;Sync fehlgeschlagen:
&quot;+(e.message||e));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} finally {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#syncBtn&quot;).disabled = false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>setBusy(false);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Bind Segmented
Controls<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>bindCaptureSegment(); bindListSegment(); bindDoctorSegment();<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Befund speichern<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>$(&quot;#saveReportBtn&quot;).addEventListener(&quot;click&quot;,
saveReport);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Initial Render<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
loadAndRender(); await renderDoctor();<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// === V1.0:
Auto-Sync beim Start (ohne Wipe) &amp; Realtime ===<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if
(!window.__booted) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
initialAutoSync();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
setupRealtime();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>window.__booted =
true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Auto-Push Pending
sobald online<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>window.addEventListener('online', async ()=&gt;{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const resPush =
await pushPendingToRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if(resPush.pushed
|| resPush.failed){<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>diag.add(`Online-Push: OK=${resPush.pushed}, FAIL=${resPush.failed}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
reconcileFromRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
reconcileReportsFromRemote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* boot */<o:p></o:p></p>

<p class=MsoNormal>if (document.readyState === &quot;loading&quot;) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>window.addEventListener(&quot;DOMContentLoaded&quot;, main);<o:p></o:p></p>

<p class=MsoNormal>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>main();<o:p></o:p></p>

<p class=MsoNormal>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>/* === Debug-Notizen<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'></span>- V1.0: Realtime ber
supabase-js; Projekt-URL aus REST-URL abgeleitet.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'></span>- Auto-Sync: push
pending &#8594; reconcile (Entries + Reports) ohne Wipe.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'></span>- Realtime-Events:
INSERT/UPDATE &#8594; upsert, DELETE &#8594; lokal entfernen.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'></span>- UI-Refresh: Listen
sofort; Charts nur, wenn Panels offen.<o:p></o:p></p>

<p class=MsoNormal>=== */<o:p></o:p></p>

<p class=MsoNormal>&lt;/script&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;!-- Google-Login
(einfach) --&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;div id=&quot;loginBar&quot;
style=&quot;position:fixed;left:8px;bottom:8px;z-index:10000;display:none;gap:8px&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn primary&quot; id=&quot;googleLoginBtn&quot;
type=&quot;button&quot;&gt;Mit Google anmelden&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span
id=&quot;whoAmI&quot; class=&quot;small&quot;
style=&quot;margin-left:8px&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button
class=&quot;btn ghost&quot; id=&quot;logoutBtn&quot; type=&quot;button&quot;
style=&quot;display:none&quot;&gt;Abmelden&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/body&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/html&gt;</p>

</div>

</body>

</html>
