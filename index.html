<!DOCTYPE html>
<!-- MODULE: BOOTSTRAP & CONSTANTS
  intent: HTML-Grundgeruest, Meta-Bootstrap, Basis-Themetokens fuer den Monolithen
  contracts: definiert Head-Struktur, laedt globale Styles, bereitet Container fuer nachgelagerte Module vor
  notes: Kommentarpflege; Markup fuer W3C-Compliance unveraendert lassen
-->
<html lang="de">
<head>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self'; connect-src 'self' https://*.supabase.co wss://*.supabase.co; img-src 'self' data:; font-src 'self' data:; object-src 'none'; base-uri 'self';">
<title>Gesundheits-Logger (V1.7.6)</title>
<link rel="stylesheet" href="assets/css/base.css">
<link rel="stylesheet" href="assets/css/layout.css">
<link rel="stylesheet" href="assets/css/capture.css">
<link rel="stylesheet" href="assets/css/app.css">
<!-- END MODULE -->
</head>
<body>
<!-- ANKER: touch-log-fallback -->
<pre id="touchLog" data-style="diag-log"></pre>

<header>
<div data-style="flex-center-gap10">
<h1>Gesundheits-Logger</h1><span class="small">V1.7.6</span>
<div class="spacer"></div>
<button class="btn ghost" id="helpToggle" type="button">Hilfe</button>
<button class="btn ghost" id="diagToggle" type="button">Log</button>
</div>
</header>

<nav class="tabs">
<button class="btn ghost" data-tab="capture" id="tab-capture" type="button">Erfassen</button>
<button class="btn ghost" data-tab="doctor" id="tab-doctor" type="button">Arzt-Ansicht</button>
</nav>

<!-- Hilfe-Panel -->
<div id="help" class="panel" role="dialog" aria-modal="false" aria-labelledby="helpTitle">
<header>
<h4 id="helpTitle">Hilfe * Was soll ich ankreuzen?</h4>
<button class="btn ghost" id="helpClose" type="button">x</button>
</header>
<div class="content">
<strong>&#x1F489; NSAR genommen</strong> ankreuzen, wenn du ein Schmerz-/Entzuendungsmedikament der Klasse NSAR genommen hast.
<ul>
<li><em>Beispiele (AT, frei):</em> Ibuprofen, Diclofenac, Naproxen.</li>
<li><em>Kombo-Achtung:</em> Viele "Erkaeltungs-/Kopfweh"-Mittel enthalten NSAR.</li>
<li><em>Bei Nierenkrankheit:</em>NSAR moeglichst vermeiden, Alternativen mit Arzt besprechen.</li>
</ul>
</div>
</div>

<!-- Diagnose-Panel -->
<div id="diag" class="panel" role="dialog" aria-modal="false" aria-labelledby="diagTitle">
<header>
<h4 id="diagTitle">Touch-Log</h4>
<button class="btn ghost" id="diagClose" type="button">x</button>
</header>
<pre id="diagLog" class="content" data-style="m-0"></pre>
</div>

<!-- Diagramm-Panel (Daily) -->
<div id="chart" class="panel chart" role="dialog" aria-modal="false" aria-labelledby="chartTitle">
<header>
<h4 id="chartTitle">Diagramm (Daily)</h4>
<button class="btn ghost" id="chartClose" type="button">x</button>
</header>
<div class="content">
<div class="controls">
<select id="metricSel" class="half compact" aria-label="Messgroesse auswaehlen">
    <option value="bp">Blutdruck (Sys/Dia)</option>
    <option value="weight">Koerper</option>
</select>

  <!-- ANKER: chart-averages (Daily) -->
  <div id="chartAverages" class="kpis" aria-live="polite">
    <span data-k="sys">Durchschnitt Sys: -</span>
    <span class="sep" aria-hidden="true">*</span>
    <span data-k="dia">Durchschnitt Dia: -</span>
    <span class="sep" aria-hidden="true">*</span>
    <span data-k="map">Durchschnitt MAP: -</span>
  </div>
</div>

<svg id="chartSvg" viewBox="0 0 640 280" preserveAspectRatio="none" role="img" aria-label="Werteverlauf"></svg>
<div class="legend" id="chartLegend"></div>
<div class="small" data-style="opacity70-mt6">Zeitraum: nutzt die <em>Arzt-Ansicht</em> (von/bis).</div>
</div>
</div>

<div id="err" role="status" aria-live="polite"></div>
<div id="busy"><div class="box"> Bitte warten...</div></div>

<main id="appMain">
<!-- END MODULE -->
<!-- MODULE: CAPTURE (Intake)
  intent: Tageserfassung (UI) inkl. Intake/BP/Body/Flags/Termine, verbindet Benutzeraktionen mit Save-Flows
  contracts: nutzt DATA ACCESS.saveIntakeTotals*, AUTH.isLoggedIn, UI.requestUiRefresh
  todo: @extract-candidate bindIntakeCapture, refreshCaptureIntake spaeter extrahieren
-->
<!-- Capture -->
<section class="view active" id="capture" aria-labelledby="captureHeading">
 
  <h2 class="sr-only" id="captureHeading">Tageserfassung</h2>
  <!-- Daily-Capture -->
  <!-- SUBMODULE: capture-entry shell @internal - wraps accordions and intake status pills -->
  <section class="card" id="entry">
    <div class="capture-header">
      <div class="capture-date">
        <div data-style="flex-fixed-220">
          <label>Datum</label>
          <input class="compact" type="date" id="date">
        </div>
      </div>
      <div class="capture-pills" id="capturePillsRow">
        <div id="cap-intake-status-top" class="small" data-style="flex-wrap-gap8-opacity80"></div>
        <span id="nextApptBadge" class="pill neutral" title="Kein Termin geplant" aria-live="polite">Kein Termin geplant</span>
      </div>
    </div>

    <!-- SUBMODULE: bp-capture accordion @internal - logs morning/abends Werte & Kommentare -->
    <details class="accordion" id="bodyAccordion">
      <summary><span>&#x1F4C8; Blutdruck</span><span class="chevron" aria-hidden="true">&#9654;</span></summary>
      <div class="accordion-body">
        <div class="card-nested">
          <div class="row" data-style="row-flex-end-gap12">
            <div data-style="minw-180">
              <label for="bpContextSel">Messzeitpunkt</label>
              <select id="bpContextSel">
                <option value="M">Morgens</option>
                <option value="A">Abends</option>
              </select>
            </div>
          </div>
        </div>
        <div class="card-nested bp-pane active" data-context="M">
          <h3 class="blockTitle">Morgens</h3>
          <div class="grid">
            <div><label>Systolisch (mmHg)</label><input type="number" id="captureAmount" inputmode="numeric" placeholder="z. B. 128"></div>
            <div><label>Diastolisch (mmHg)</label><input type="number" id="diaM" inputmode="numeric" placeholder="z. B. 82"></div>
            <div><label>Puls (bpm)</label><input type="number" id="pulseM" inputmode="numeric" placeholder="z. B. 66"></div>
          </div>
          <div class="row" data-style="mt-6">
            <textarea id="bpCommentM" class="small" placeholder="Kommentar Morgens (optional)"></textarea>
          </div>
        </div>
        <div class="card-nested bp-pane" data-context="A">
          <h3 class="blockTitle">Abends</h3>
          <div class="grid">
            <div><label>Systolisch (mmHg)</label><input type="number" id="sysA" inputmode="numeric" placeholder="z. B. 128"></div>
            <div><label>Diastolisch (mmHg)</label><input type="number" id="diaA" inputmode="numeric" placeholder="z. B. 82"></div>
            <div><label>Puls (bpm)</label><input type="number" id="pulseA" inputmode="numeric" placeholder="z. B. 66"></div>
          </div>
          <div class="row" data-style="mt-6">
            <textarea id="bpCommentA" class="small" placeholder="Kommentar Abends (optional)"></textarea>
          </div>
        </div>
        <div class="panel-actions">
          <button class="btn primary" id="saveBpPanelBtn" type="button">&#x1F4BE; Blutdruck speichern</button>
        </div>
      </div>
    </details>

    <!-- SUBMODULE: body-capture accordion @internal - captures weight + Umfang Werte -->
    <details class="accordion">
      <summary><span>&#x2696;&#xFE0F; Koerper</span><span class="chevron" aria-hidden="true">&#9654;</span></summary>
      <div class="accordion-body">
          <div class="card-nested">
            <div class="body-grid">
              <div>
                <label>Gewicht (kg)</label>
                <input type="number" step="0.1" id="weightDay" inputmode="decimal" placeholder="z. B. 84.2">
              </div>
              <div>
                <label>Bauchumfang (cm)</label>
                <input id="input-waist-cm" type="text" inputmode="decimal" autocomplete="off" placeholder="z. B. 104,5">
              </div>
              <div>
                <label>Fett (%)</label>
                <input id="fatPctDay" type="text" inputmode="decimal" autocomplete="off" placeholder="z. B. 22,5">
              </div>
              <div>
                <label>Muskel (%)</label>
                <input id="musclePctDay" type="text" inputmode="decimal" autocomplete="off" placeholder="z. B. 38,0">
              </div>
            </div>
          </div>
        
        <div class="panel-actions">
          <button class="btn primary" id="saveBodyPanelBtn" type="button">&#x1F4BE; Koerper speichern</button>
        </div>
      </div>
    </details>

    <!-- SUBMODULE: intake-capture accordion @internal - updates water/salt/protein totals -->
    <details class="accordion" id="captureIntake">
      <summary><span>&#x1F964; Fluessigkeit & Intake</span><span class="chevron" aria-hidden="true">&#9654;</span></summary>
      <div class="accordion-body">
        <div class="card-nested" id="cap-intake-wrap">
          <h3 class="blockTitle">Intake pro Tag</h3>
          <div class="small" id="cap-intake-status" data-style="mb10-opacity80"></div>

          <div class="row" data-style="row-flex-end-gap8">
            <div data-style="flex-grow-min180">
              <label>Wasser hinzufuegen (ml)</label>
              <input type="number" id="cap-water-add" min="0" step="50" inputmode="numeric" placeholder="z. B. 250">
            </div>
            <div data-style="w-140">
              <button class="btn primary" id="cap-water-add-btn" type="button">+ Menge</button>
            </div>
          </div>

          <div class="row" data-style="row-flex-end-gap8-mt12">
            <div data-style="flex-grow-min180">
              <label>Salz hinzufuegen (g)</label>
              <input type="text" id="cap-salt-add" inputmode="decimal" autocomplete="off" placeholder="z. B. 0,5">
            </div>
            <div data-style="w-140">
              <button class="btn primary" id="cap-salt-add-btn" type="button">+ Menge</button>
            </div>
          </div>

          <div class="row" data-style="row-flex-end-gap8-mt12">
            <div data-style="flex-grow-min180">
              <label>Protein hinzufuegen (g)</label>
              <input type="text" id="cap-protein-add" inputmode="decimal" autocomplete="off" placeholder="z. B. 20,0">
            </div>
            <div data-style="w-140">
              <button class="btn primary" id="cap-protein-add-btn" type="button">+ Menge</button>
            </div>
          </div>

          <div class="small" data-style="mt10-opacity75">
            Hinweis: Werte werden fuer das gewaehlte Datum gespeichert und synchronisiert.
          </div>
        </div>
      </div>
    </details>

    <!-- SUBMODULE: day-flags accordion @internal - toggles training/sick/salt states -->
    <details class="accordion">
      <summary><span>&#x1F6A9; Flags</span><span class="chevron" aria-hidden="true">&#9654;</span></summary>
      <div class="accordion-body">
        <div class="card-nested">
          <div class="row" data-style="row-flex-center-gap8">
            <button class="btn toggle" id="trainingToggle" type="button" aria-pressed="false">&#x1F3CB;&#xFE0F; Training heute</button>
            <button class="btn toggle" id="sickToggle" type="button" aria-pressed="false">&#x1F912; Krank (Forxiga pausiert)</button>
            <button class="btn toggle" id="valsartanMissToggle" type="button" aria-pressed="false">&#x1F48A; Valsartan vergessen</button>
            <button class="btn toggle" id="forxigaMissToggle" type="button" aria-pressed="false">&#x23F0; Forxiga vergessen</button>
            <button class="btn toggle" id="lowIntakeToggle" type="button" aria-pressed="false">&#x1F4A7; &lt; 2 L getrunken</button>
            <button class="btn toggle" id="saltHighToggle" type="button" aria-pressed="false" title="> 5 g Salz">&#x1F9C2; &gt; 5 g Salz</button>
            <button class="btn toggle" id="proteinHighToggle" type="button" aria-pressed="false" title="Protein >= 90 g">&#x1F969; Protein >= 90 g</button>
            <button class="btn toggle" id="nsarToggle" type="button" aria-pressed="false" title="Nicht-steroidale Antirheumatika">&#x1F489; NSAR genommen</button>
          </div>
        </div>
        <div class="card-nested">
          <label for="flagsComment" class="small" data-style="block-mb6">Kommentar zu Flags</label>
          <textarea id="flagsComment" placeholder="Kommentar zu Flags (optional)" rows="2"></textarea>
        </div>
        <div class="panel-actions">
          <button class="btn primary" id="saveFlagsPanelBtn" type="button">&#x1F4BE; Flags speichern</button>
        </div>
      </div>

</details>

<!-- SUBMODULE: appointments accordion @internal - manages per-role appointment cards -->
<details class="accordion" id="appointments">
  <summary><span>&#x1F4C5; Arzttermine</span><span class="chevron" aria-hidden="true">&#9654;</span></summary>
  <div class="accordion-body">
    <div class="card-nested" id="appointmentsWrap">
      <div class="small" data-style="mb12-opacity80">Pro Rolle gibt es genau einen geplanten Termin.</div>

      <div class="appointment-card" data-role="nephro">
        <h3 class="blockTitle">Nephrologe</h3>
        <div class="appointment-inputs">
          <div>
            <label for="appt-nephro-date">Datum</label>
            <input type="date" id="appt-nephro-date">
          </div>
          <div>
            <label for="appt-nephro-time">Zeit</label>
            <input type="time" id="appt-nephro-time">
          </div>
          <div class="btn-wrap">
            <button class="btn primary" id="appt-nephro-save" type="button">Speichern</button>
          </div>
        </div>
        <div class="appointment-meta">
          <div class="appointment-line">
            <span class="label">Naechster Termin:</span>
            <span class="value" id="appt-nephro-next">&mdash;</span>
            <button class="btn ghost" id="appt-nephro-done" type="button" disabled>Done</button>
          </div>
          <div class="appointment-line">
            <span class="label">Letzter Termin:</span>
            <span class="value" id="appt-nephro-last">&mdash;</span>
          </div>
        </div>
      </div>

      <div class="appointment-card" data-role="internal">
        <h3 class="blockTitle">Internist</h3>
        <div class="appointment-inputs">
          <div>
            <label for="appt-internal-date">Datum</label>
            <input type="date" id="appt-internal-date">
          </div>
          <div>
            <label for="appt-internal-time">Zeit</label>
            <input type="time" id="appt-internal-time">
          </div>
          <div class="btn-wrap">
            <button class="btn primary" id="appt-internal-save" type="button">Speichern</button>
          </div>
        </div>
        <div class="appointment-meta">
          <div class="appointment-line">
            <span class="label">Naechster Termin:</span>
            <span class="value" id="appt-internal-next">&mdash;</span>
            <button class="btn ghost" id="appt-internal-done" type="button" disabled>Done</button>
          </div>
          <div class="appointment-line">
            <span class="label">Letzter Termin:</span>
            <span class="value" id="appt-internal-last">&mdash;</span>
          </div>
        </div>
      </div>

      <div class="appointment-card" data-role="urology">
        <h3 class="blockTitle">Urologe</h3>
        <div class="appointment-inputs">
          <div>
            <label for="appt-urology-date">Datum</label>
            <input type="date" id="appt-urology-date">
          </div>
          <div>
            <label for="appt-urology-time">Zeit</label>
            <input type="time" id="appt-urology-time">
          </div>
          <div class="btn-wrap">
            <button class="btn primary" id="appt-urology-save" type="button">Speichern</button>
          </div>
        </div>
        <div class="appointment-meta">
          <div class="appointment-line">
            <span class="label">Naechster Termin:</span>
            <span class="value" id="appt-urology-next">&mdash;</span>
            <button class="btn ghost" id="appt-urology-done" type="button" disabled>Done</button>
          </div>
          <div class="appointment-line">
            <span class="label">Letzter Termin:</span>
            <span class="value" id="appt-urology-last">&mdash;</span>
          </div>
        </div>
      </div>

      <div class="appointment-card" data-role="dentist">
        <h3 class="blockTitle">Zahnarzt</h3>
        <div class="appointment-inputs">
          <div>
            <label for="appt-dentist-date">Datum</label>
            <input type="date" id="appt-dentist-date">
          </div>
          <div>
            <label for="appt-dentist-time">Zeit</label>
            <input type="time" id="appt-dentist-time">
          </div>
          <div class="btn-wrap">
            <button class="btn primary" id="appt-dentist-save" type="button">Speichern</button>
          </div>
        </div>
        <div class="appointment-meta">
          <div class="appointment-line">
            <span class="label">Naechster Termin:</span>
            <span class="value" id="appt-dentist-next">&mdash;</span>
            <button class="btn ghost" id="appt-dentist-done" type="button" disabled>Done</button>
          </div>
          <div class="appointment-line">
            <span class="label">Letzter Termin:</span>
            <span class="value" id="appt-dentist-last">&mdash;</span>
          </div>
        </div>
      </div>

      <div class="appointment-card" data-role="ophtha">
        <h3 class="blockTitle">Augenarzt</h3>
        <div class="appointment-inputs">
          <div>
            <label for="appt-ophtha-date">Datum</label>
            <input type="date" id="appt-ophtha-date">
          </div>
          <div>
            <label for="appt-ophtha-time">Zeit</label>
            <input type="time" id="appt-ophtha-time">
          </div>
          <div class="btn-wrap">
            <button class="btn primary" id="appt-ophtha-save" type="button">Speichern</button>
          </div>
        </div>
        <div class="appointment-meta">
          <div class="appointment-line">
            <span class="label">Naechster Termin:</span>
            <span class="value" id="appt-ophtha-next">&mdash;</span>
            <button class="btn ghost" id="appt-ophtha-done" type="button" disabled>Done</button>
          </div>
          <div class="appointment-line">
            <span class="label">Letzter Termin:</span>
            <span class="value" id="appt-ophtha-last">&mdash;</span>
          </div>
        </div>
      </div>

      <div class="appointment-card" data-role="physio">
        <h3 class="blockTitle">Physiotherapie</h3>
        <div class="appointment-inputs">
          <div>
            <label for="appt-physio-date">Datum</label>
            <input type="date" id="appt-physio-date">
          </div>
          <div>
            <label for="appt-physio-time">Zeit</label>
            <input type="time" id="appt-physio-time">
          </div>
          <div class="btn-wrap">
            <button class="btn primary" id="appt-physio-save" type="button">Speichern</button>
          </div>
        </div>
        <div class="appointment-meta">
          <div class="appointment-line">
            <span class="label">Naechster Termin:</span>
            <span class="value" id="appt-physio-next">&mdash;</span>
            <button class="btn ghost" id="appt-physio-done" type="button" disabled>Done</button>
          </div>
          <div class="appointment-line">
            <span class="label">Letzter Termin:</span>
            <span class="value" id="appt-physio-last">&mdash;</span>
          </div>
        </div>
      </div>

      <div class="small" data-style="opacity-70">Hinweis: Logik folgt in den naechsten Phasen - aktuell nur UI-Skelett.</div>
    </div>
  </div>
</details>

  </section>
</section>
<!-- END MODULE -->

<!-- Lifestyle (Heute) -->


<!-- MODULE: DOCTOR VIEW
  intent: Aggregations-UI fuer Aerzt:innen, steuert Zeitraum-Filter, Export und Chart-Pivot
  contracts: nutzt DATA ACCESS.fetchDailyOverview, CHARTS.renderDailyChart, AUTH.setDoctorAccess @public
  todo: @extract-candidate buildDoctorSummaryJson @public spaeter bereitstellen
-->
<!-- Doctor -->
<section class="view" id="doctor" aria-labelledby="doctorHeading">
  <h2 class="sr-only" id="doctorHeading">Arzt-Ansicht</h2>
  <div class="card" id="doctorCard">
    <div class="toolbar">
      <strong id="doctorTitle">Arzt-Ansicht</strong>

      <div class="center-group">
        <label class="small">Von <input type="date" id="from" data-style="w-auto"></label>
        <label class="small">Bis <input type="date" id="to" data-style="w-auto"></label>
        <button class="btn ghost" id="applyRange" type="button">Anwenden</button>
        <button class="btn ghost" id="doctorChartBtn" type="button" title="Werte als Grafik">Werte anzeigen</button>
        <button class="btn ghost" id="doctorExportJson" type="button">Export JSON</button>
      </div>

      <span id="docTrainCnt" class="badge good" title="Anzahl Tage mit Training im Zeitraum"> Trainingstage: <span class="val">0</span></span>
      <span id="docBadCnt" class="badge bad" title="Anzahl Tage mit mind. einem Bad-Flag"> Tage mit Bad-Flag: <span class="val">0</span></span>
    </div> <!--  Toolbar sauber schliessen -->

    <div data-style="overflow-auto" id="doctorDailyWrap">
      <div class="doctor-view" id="doctorView"></div>
    </div>

        <div class="small" data-style="mt-6">
      Tipp: "Werte anzeigen" oeffnet die passende Grafik zum aktuellen Tab (Daily).
    </div>
  </div>
</section>

<!-- END MODULE -->

</main>

<!-- Supabase (UMD, v2) -->
<script
  src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"
  integrity="sha384-0w2KAL2YHP6wKOkUDzkCDGgVvfmHnj02DHeQ6XcHOgTfFsGyonKOpShMH1x6nk9o"
  crossorigin="anonymous"
></script>


<script src="assets/js/diagnostics.js"></script>
<!-- @refactor: moved to assets/js/ui.js -->
<script src="assets/js/ui.js"></script>
<!-- @refactor: moved to assets/js/ui-layout.js -->
<script src="assets/js/ui-layout.js"></script>
<!-- @refactor: moved to assets/js/ui-errors.js -->
<script src="assets/js/ui-errors.js"></script>
<!-- @refactor: moved to assets/js/utils.js -->
<script src="assets/js/utils.js"></script>
<!-- @refactor: moved to assets/js/format.js -->
<script src="assets/js/format.js"></script>
<!-- @refactor: moved to assets/js/config.js -->
<script src="assets/js/config.js"></script>
<!-- @refactor: moved to assets/js/capture/globals.js -->
<script src="assets/js/capture/globals.js"></script>
<!-- @refactor: moved to assets/js/data-local.js -->
<script src="assets/js/data-local.js"></script>
<!-- @refactor: moved to assets/js/capture/index.js -->
<script src="assets/js/capture/index.js"></script>
<!-- @refactor: moved to assets/js/capture/flags.js -->
<script src="assets/js/capture/flags.js"></script>
<!-- @refactor: moved to assets/js/bp.js -->
<script src="assets/js/bp.js"></script>
<!-- @refactor: moved to assets/js/body.js -->
<script src="assets/js/body.js"></script>
<!-- @refactor: moved to assets/js/appointments.js -->
<script src="assets/js/appointments.js"></script>
<!-- @refactor: moved to assets/js/doctor/index.js -->
<script src="assets/js/doctor/index.js"></script>
<!-- @refactor: moved to assets/js/charts/index.js -->
<script src="assets/js/charts/index.js"></script>
<!-- @refactor: moved to assets/js/supabase/index.js -->
<script type="module" src="assets/js/supabase/index.js"></script>

<script type="module" src="assets/js/boot-auth.js"></script>
<!-- @refactor: moved to assets/js/ui-tabs.js -->
<script src="assets/js/ui-tabs.js"></script>

<script src="assets/js/main.js"></script>
<!-- Login-Overlay (zentriert) -->
<div id="loginOverlay" data-style="u-hidden">
  <div class="login-card" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
    <h3 id="loginTitle">Willkommen</h3>
    <p class="small" data-style="mb-8">Melde dich an, um Arzt-Ansicht & Diagramme zu nutzen.</p>
    <button class="btn primary" id="googleLoginBtn" type="button" data-style="w100-h48-mb12">Mit Google anmelden</button>
    <details id="configAdv" class="config-box" data-style="mb-12">
      <summary class="small" data-style="config-summary">Erweiterte Einstellungen</summary>
      <div data-style="flex-col-gap6-mt4">
        <label class="small" for="configRestUrl">Supabase REST-Endpoint</label>
        <input id="configRestUrl" type="url" inputmode="url" placeholder="https://...supabase.co/rest/v1/health_events" data-style="input-field">
        <label class="small" for="configAnonKey" data-style="mt-4">Supabase ANON-Key</label>
        <textarea id="configAnonKey" rows="3" placeholder="ANON-Key (kein service_role)" data-style="textarea-field"></textarea>
        <button class="btn ghost" id="configSaveBtn" type="button" data-style="w100-mt4">Konfiguration speichern</button>
        <div id="configStatus" class="small" data-style="status-muted"></div>
      </div>
    </details>
    <div id="whoAmI" class="small" data-style="text-center-mt6"></div>
  </div>
</div>

<!-- App-Lock Overlay (zentriert) -->
<div id="appLock" data-style="u-hidden">
  <div class="lock-card" role="dialog" aria-modal="true" aria-labelledby="lockTitle">
    <h3 id="lockTitle">App gesperrt</h3>
    <p class="small" data-style="mb-8">
      Bitte entsperren: bevorzugt per Passkey (Finger/Face). Alternativ PIN.
    </p>

    <div class="row" data-style="gap-8">
      <button class="btn primary" id="unlockPasskeyBtn" type="button" data-style="w100-h48">
        Per Passkey entsperren
      </button>
    </div>

    <div class="pin-wrap">
      <input id="pinInput" type="password" inputmode="numeric" autocomplete="off" placeholder="PIN (optional)">
      <button class="btn ghost" id="unlockPinBtn" type="button">PIN</button>
    </div>

    <div class="small" data-style="mt8-opacity80">
      <button class="btn ghost" id="setupPasskeyBtn" type="button" data-style="w100-mt6">
        Passkey einrichten
      </button>
      <button class="btn ghost" id="setPinBtn" type="button" data-style="w100-mt6">
        PIN setzen/aendern
      </button>
    </div>

    <button class="btn ghost" id="lockCancelBtn" type="button" data-style="w100-mt8">
      Abbrechen
    </button>

    <div id="lockMsg" class="small" data-style="mt6-muted"></div>
  </div>
</div>

</body>
</html>

<!-- ANNOTATION SUMMARY
  modules:
    - BOOTSTRAP & CONSTANTS -> #SUBMODULES: 0, #@extract: 0, Exports:[none]
    - CAPTURE (Intake) - HTML Shell -> #SUBMODULES: 0, #@extract: 0, Exports:[none]
    - DOCTOR VIEW - HTML -> #SUBMODULES: 0, #@extract: 0, Exports:[none]
    - CONFIG -> #SUBMODULES: 0, #@extract: 0, Exports:[DEV_ALLOW_DEFAULTS, APPOINTMENT_ROLES]
    - LOGGING & DIAGNOSTICS -> #SUBMODULES: 2, #@extract: 0, Exports:[diag, recordPerfStat, uiError, uiInfo]
    - UI / ROUTING / VIEWS - Core (Refresh/Help) -> #SUBMODULES: 7, #@extract: 0, Exports:[requestUiRefresh, runUiRefresh, maybeRefreshForTodayChange, setUnderlayInert]
    - AUTH - Guards -> #SUBMODULES: 3, #@extract: 0, Exports:[isLoggedIn, isLoggedInFast, setAuthGuard, setDoctorAccess]
    - UTILITIES -> #SUBMODULES: 0, #@extract: 0, Exports:[$,$$,fmtNum,todayStr,timeStr,esc,nl2br]
    - CAPTURE (Intake) - State & Timer -> #SUBMODULES: 0, #@extract: 5, Exports:[refreshCaptureIntake, scheduleMidnightRefresh, maybeResetIntakeForToday, bindIntakeCapture, updateCaptureIntakeStatus] (moved to assets/js/capture/index.js)
    - DATA ACCESS (IndexedDB) -> #SUBMODULES: 2, #@extract: 0, Exports:[initDB, putConf, getConf, addEntry, updateEntry, getAllEntries, getEntryByRemoteId, deleteEntryLocal, dayIsoToMidnightIso]
    - AUTH - Header Cache -> #SUBMODULES: 1, #@extract: 0, Exports:[getHeaders]
    - DATA ACCESS (REST/RPC) -> #SUBMODULES: 30, #@extract: 1, Exports:[deleteRemote, loadIntakeToday, saveIntakeTotals, saveIntakeTotalsRpc, fetchDailyOverview, deleteRemoteDay]
    - APPOINTMENTS -> #SUBMODULES: 0, #@extract: 12, Exports:[refreshAppointments, handleAppointmentSave, handleAppointmentDone, bindAppointmentsPanel, setAppointmentBadge] (moved to assets/js/appointments.js)
    - CAPTURE (Intake) - Status & RPC Hooks -> #SUBMODULES: 0, #@extract: 7, Exports:[clearCaptureIntakeInputs, setCaptureIntakeDisabled, prepareIntakeStatusHeader, updateCaptureIntakeStatus, handleCaptureIntake] (moved to assets/js/capture/index.js)
    - DOCTOR VIEW - Logic -> #SUBMODULES: 3, #@extract: 1, Exports:[renderDoctor, setDocBadges, renderDoctorDay, exportDoctorJson]
    - CHARTS (SVG/Canvas) -> #SUBMODULES: 15, #@extract: 3, Exports:[chartPanel]
    - UI / ROUTING / VIEWS - Navigation (Tabs/Resume/Focus) -> #SUBMODULES: 1, #@extract: 1, Exports:[setTab, bindTabs]
    - CAPTURE (Intake) - Flag Toggles -> #SUBMODULES: 0, #@extract: 1, Exports:[setProteinHigh, setTraining, setLowIntake, setSaltHigh] (moved to assets/js/capture/index.js)
    - BP (Blood Pressure) - Validierung -> #SUBMODULES: 0, #@extract: 5, Exports:[requiresBpComment, updateBpCommentWarnings, resetBpPanel] (moved to assets/js/bp.js)
    - CAPTURE (Intake) - Panel Resets & Shortcuts -> #SUBMODULES: 0, #@extract: 8, Exports:[resetBodyPanel, resetFlagsPanel, resetCapturePanels, addCapturePanelKeys, setSick, setValsartanMiss, setForxigaMiss, setNsar] (moved to assets/js/capture/index.js)
    - BP (Blood Pressure) - Persistenz -> #SUBMODULES: 0, #@extract: 6, Exports:[saveBlock, appendNote, allocateNoteTimestamp] (moved to assets/js/bp.js)
    - BODY (Koerperwerte) -> #SUBMODULES: 0, #@extract: 1, Exports:[resetBodyPanel, saveDaySummary, saveFlagsCommentNote, prefillBodyInputs] (moved to assets/js/body.js)
    - DATA ACCESS (Auth Helpers) -> #SUBMODULES: 3, #@extract: 2, Exports:[withRetry, fetchWithAuth, syncWebhook]
    - REALTIME -> #SUBMODULES: 17, #@extract: 8, Exports:[ensureSupabaseClient, setupRealtime, requireDoctorUnlock, resumeFromBackground]
    - FUTURE (placeholders) -> #SUBMODULES: 3, #@extract: 0, Exports:[assistHooks (planned), pwaBootstrap (planned), bleIntegration (planned)]
  total @extract-candidate markers: 18
-->
















